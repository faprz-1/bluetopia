(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[9537],{7254:(t,e,i)=>{"use strict";i.d(e,{R:()=>a});var n=i(8318),r=i(8470),s=i(5024),o=i(9996);function a(t,e,i,c){return(0,s.m)(i)&&(c=i,i=void 0),c?a(t,e,i).pipe((0,o.U)(t=>(0,r.k)(t)?c(...t):c(t))):new n.y(n=>{l(t,e,function(t){n.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},n,i)})}function l(t,e,i,n,r){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const n=t;t.addEventListener(e,i,r),s=()=>n.removeEventListener(e,i,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const n=t;t.on(e,i),s=()=>n.off(e,i)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const n=t;t.addListener(e,i),s=()=>n.removeListener(e,i)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let s=0,o=t.length;s<o;s++)l(t[s],e,i,n,r)}n.add(s)}},810:(t,e,i)=>{"use strict";i.d(e,{e:()=>l});var n=i(8569),r=i(6882);class s{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new o(t,this.durationSelector))}}class o extends r.Ds{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let i;try{const{durationSelector:e}=this;i=e(t)}catch(e){return this.destination.error(e)}const n=(0,r.ft)(i,new r.IY(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}clearThrottle(){const{value:t,hasValue:e,throttled:i}=this;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),e&&(this.value=void 0,this.hasValue=!1,this.destination.next(t))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}var a=i(1110);function l(t,e=n.P){return i=()=>(0,a.H)(t,e),function(t){return t.lift(new s(i))};var i}},5416:(t,e,i)=>{"use strict";i.d(e,{R:()=>r});var n=i(6882);function r(t){return e=>e.lift(new s(t))}class s{constructor(t){this.notifier=t}call(t,e){const i=new o(t),r=(0,n.ft)(this.notifier,new n.IY(i));return r&&!i.seenValue?(i.add(r),e.subscribe(i)):i}}class o extends n.Ds{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}},1741:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(8277);class r extends n.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(()=>t.flush(null))))}recycleAsyncId(t,e,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(t,e,i);0===t.actions.length&&(cancelAnimationFrame(e),t.scheduled=void 0)}}var s=i(1098);class o extends s.v{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let i,n=-1,r=e.length;t=t||e.shift();do{if(i=t.execute(t.state,t.delay))break}while(++n<r&&(t=e.shift()));if(this.active=!1,i){for(;++n<r&&(t=e.shift());)t.unsubscribe();throw i}}}const a=new o(r)},6158:(t,e,i)=>{"use strict";i.d(e,{w:()=>a});var n=i(5821),r=i(7368),s=i(1116);function o(t,e){if(1&t&&(r.TgZ(0,"div",1),r._uU(1),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.hij(" ",null==t.errorMessage?null:t.errorMessage.label,"\n")}}let a=(()=>{class t{constructor(){}ngOnInit(){}get errorMessage(){var t,e,i,r;for(let s in null===(t=this.control)||void 0===t?void 0:t.errors)if((null===(e=this.control)||void 0===e?void 0:e.errors.hasOwnProperty(s))&&(null===(i=this.control)||void 0===i?void 0:i.touched))return n.R.GetValidatorErrorMessage(s,null===(r=this.control)||void 0===r?void 0:r.errors[s]);return null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-control-messages"]],inputs:{control:"control"},decls:1,vars:1,consts:[["class","color-red",4,"ngIf"],[1,"color-red"]],template:function(t,e){1&t&&r.YNc(0,o,2,1,"div",0),2&t&&r.Q6J("ngIf",null!==e.errorMessage)},directives:[s.O5],styles:[""]}),t})()},9130:(t,e,i)=>{"use strict";i.r(e),i.d(e,{VerificationModule:()=>A});var n=i(1116),r=i(2894),s=i(4391),o=i(1041),a=i(6050),l=i(9609),c=i(5821),d=i(7368),u=i(407),h=i(1392),g=i(6189),m=i(2874),p=i(8118),f=i(6158);function v(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"form",18),d.TgZ(1,"div",19),d.TgZ(2,"div",20),d._UZ(3,"img",21),d.qZA(),d.TgZ(4,"input",22),d.NdJ("input",function(){return d.CHM(t),d.oxw().OnPasswordChange()}),d.qZA(),d._UZ(5,"app-control-messages",23),d.qZA(),d.TgZ(6,"div",19),d.TgZ(7,"div",20),d._UZ(8,"img",21),d.qZA(),d._UZ(9,"input",24),d._UZ(10,"app-control-messages",23),d.qZA(),d.qZA()}if(2&t){const t=d.oxw();d.Q6J("formGroup",t.passwordForm),d.xp6(5),d.Q6J("control",t.passwordForm.get("password")),d.xp6(5),d.Q6J("control",t.passwordForm.get("confirmPassword"))}}function w(t,e){1&t&&(d.TgZ(0,"span"),d._uU(1,"Continuar"),d.qZA())}function b(t,e){1&t&&(d.TgZ(0,"span"),d._UZ(1,"i",25),d.qZA())}function Z(t,e){1&t&&(d.TgZ(0,"div",26),d._UZ(1,"i",27),d.qZA())}const y=[{path:"",component:(()=>{class t{constructor(t,e,i,n,r,s){this.nav=t,this.activatedRoute=e,this.api=i,this.toast=n,this.notiServ=r,this.pushService=s,this.loading={checkingCode:!1,updatingPassword:!1},this.teacher=null,this.activationToken=null,this.passwordForm=new o.cw({password:new o.NI("",[o.kI.required,o.kI.minLength(3)]),confirmPassword:new o.NI("",[o.kI.required,o.kI.minLength(3)])})}ngOnInit(){this.GetParams()}GetParams(){this.activatedRoute.params.subscribe(t=>{this.activationToken=t.activationToken,this.GetTeacher()})}GetTeacher(){this.loading.checkingCode=!0,this.api.Get(`/Teachers/ByActivationToken/${this.activationToken}`).subscribe(t=>{this.teacher=t,this.loading.checkingCode=!1},t=>{console.error("Error getting teacher",t),this.loading.checkingCode=!1,"invalid token"==t.error.error.message&&this.toast.ShowError("Este link ya ha expirado")})}OnPasswordChange(){var t,e;const i=null===(t=this.passwordForm.get("password"))||void 0===t?void 0:t.value;null===(e=this.passwordForm.get("confirmPassword"))||void 0===e||e.setValidators([o.kI.required,o.kI.minLength(3),c.R.matchString(i)])}SetPasswordAndLogin(){if(this.passwordForm.invalid)return this.toast.ShowWarning("Favor de llenar todos los campos correctamente"),void this.passwordForm.markAllAsTouched();let t=this.passwordForm.value;this.loading.updatingPassword=!0,this.api.Patch(`/Teachers/${this.teacher.id}/Activate`,{password:t.password}).subscribe(e=>{this.Login({email:this.teacher.email,password:t.password})},t=>{console.error("error activating teacher",t),this.loading.updatingPassword=!1})}Login(t){this.api.Post("/Usuarios/login",{email:t.email,password:t.password},!1).subscribe(t=>{localStorage.clear(),this.api.SetToken(t.id),this.api.Get("/Usuarios/withCredentials",!0).subscribe(t=>{localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("ttl",l().add(1209600,"s").toISOString()),this.notiServ.LoadNotifications(),this.pushService.GetUserID(),this.toast.ShowSuccess("Sesi\xf3n iniciada exitosamente");let e=this.api.GetUser().role.name.toLowerCase();this.loading.updatingPassword=!1,this.nav.GoTo(`/inicio/${e}/`)},t=>{this.loading.updatingPassword=!1,this.toast.ShowError(t.error.error.message)})},t=>{this.loading.updatingPassword=!1,this.toast.ShowError(t.error.error.message)})}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(u.f),d.Y36(r.gz),d.Y36(h.sM),d.Y36(g.k),d.Y36(m.g),d.Y36(p._))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-verification"]],decls:24,vars:5,consts:[[1,"full-page"],[1,"d-flex","h-100"],["src","assets/img/landing_page_side.png","alt","Side img",1,"side-img"],[1,"w-100","vertical-content"],[1,"row","m-0"],[1,"col-12","text-center"],["src","assets/img/project_name.png","alt","Bluetopia",1,"title-img"],[1,"header-container"],[1,"title"],["src","assets/img/landing_page_img.png","alt","Image",1,"landing-image"],[1,"subtitle"],[1,"text-center"],["class","form-container",3,"formGroup",4,"ngIf","ngIfElse"],[1,"mt-5"],[1,"d-flex","justify-content-center"],[1,"btn","btn-outline-primary","btn-bigger",3,"disabled","click"],[4,"ngIf"],["bigLoading",""],[1,"form-container",3,"formGroup"],[1,"input-container"],[1,"input-icon-container","text-center"],["src","assets/icons/lock.png"],["type","password","placeholder","Contrase\xf1a","formControlName","password",1,"form-control",3,"input"],[3,"control"],["type","password","placeholder","Confirmar contrase\xf1a","formControlName","confirmPassword",1,"form-control"],[1,"zmdi","zmdi-spinner","zmdi-hc-2x","zmdi-hc-spin"],[1,"w-100","text-center"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"]],template:function(t,e){if(1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d._UZ(2,"img",2),d.TgZ(3,"div",3),d.TgZ(4,"div",4),d.TgZ(5,"div",5),d.TgZ(6,"div"),d._UZ(7,"img",6),d.qZA(),d.TgZ(8,"div",7),d.TgZ(9,"div",8),d._uU(10," \xa1Bienvenido! "),d.qZA(),d.TgZ(11,"div"),d._UZ(12,"img",9),d.qZA(),d.TgZ(13,"div",10),d._uU(14," Para temrinar la creaci\xf3n de su cuenta porfavor ingrese una contrase\xf1a "),d.qZA(),d.qZA(),d.TgZ(15,"div",11),d.YNc(16,v,11,3,"form",12),d.qZA(),d.TgZ(17,"div",13),d.TgZ(18,"div",14),d.TgZ(19,"button",15),d.NdJ("click",function(){return e.SetPasswordAndLogin()}),d.YNc(20,w,2,0,"span",16),d.YNc(21,b,2,0,"span",16),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(22,Z,2,0,"ng-template",null,17,d.W1O)),2&t){const t=d.MAs(23);d.xp6(16),d.Q6J("ngIf",!e.loading.checkingCode)("ngIfElse",t),d.xp6(3),d.Q6J("disabled",e.loading.updatingPassword||e.loading.checkingCode),d.xp6(1),d.Q6J("ngIf",!e.loading.updatingPassword),d.xp6(1),d.Q6J("ngIf",e.loading.updatingPassword)}},directives:[n.O5,o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,f.w],styles:[".title[_ngcontent-%COMP%]{margin:1rem 0}.landing-image[_ngcontent-%COMP%]{margin:38px 0;max-height:150px}.header-container[_ngcontent-%COMP%]{max-width:500px;display:inline-block}.subtitle[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:500;color:#758ca6;margin-bottom:50px}.form-container[_ngcontent-%COMP%]{display:inline-block;max-width:500px;width:100%}"]}),t})()}];let A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[o.u5,n.ez,s.A0,o.UX,a.G,r.Bz.forChild(y)]]}),t})()},407:(t,e,i)=>{"use strict";i.d(e,{f:()=>o});var n=i(7368),r=i(2894),s=i(1392);let o=(()=>{class t{constructor(t,e){this.router=t,this.api=e,this.user=null}HasInitialSlash(t){return!!t&&"/"==t.charAt(0)}GoToUserRoute(t){this.user=this.api.GetUser(),this.user&&(this.user&&this.user.role&&!t.includes(this.user.role.name.toLowerCase())?this.router.navigate([`/inicio/${this.user.role.name.toLowerCase()}${this.HasInitialSlash(t)?"":"/"}${t}`]):this.router.navigate([`${this.HasInitialSlash(t)?"":"/"}${t}`]))}GoTo(t){this.router.navigate([`${this.HasInitialSlash(t)?"":"/"}${t}`])}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(r.F0),n.LFG(s.sM))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},2874:(t,e,i)=>{"use strict";i.d(e,{g:()=>o});var n=i(6304),r=i(7368),s=i(1392);let o=(()=>{class t{constructor(t){this.api=t,this.notifications=[]}Init(){this.LoadNotifications(),this.SusbcribeToNotifications()}SusbcribeToNotifications(){}LoadNotifications(t=!1){let e="/Notifications/getLast5";e+=t?"/"+t:"",this.api.Get(e).subscribe(t=>{this.notifications.push.apply(this.notifications,t)})}CountUnseen(){let t=0;return this.notifications.forEach(e=>{null==e.seen&&t++}),t}SetSeen(t){var e=this;return(0,n.Z)(function*(){if(null==t.seen){let i=yield e.api.Get("/Notifications/setSeen/"+t.id);e.notifications.forEach((t,n)=>{t.id==t.id&&(e.notifications[n]=i)})}})()}PrepareUrl(t){return t?t.split("/#")[1]:""}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(s.sM))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},5821:(t,e,i)=>{"use strict";i.d(e,{R:()=>r});var n=i(7368);let r=(()=>{class t{constructor(){}static GetValidatorErrorMessage(t,e){return[{name:"required",label:"Campo requerido"},{name:"invalidRFC",label:"No tiene el formato adecuado"},{name:"invalidEmailAddress",label:"Correo inv\xe1lido"},{name:"invalidPassword",label:"Las contrase\xf1as no coinciden"},{name:"minlength",label:`M\xednimo ${e.requiredLength} caracteres `},{name:"maxlength",label:`M\xe1ximo ${e.requiredLength} caracteres `},{name:"invalidNumber",label:"Solo n\xfameros enteros, o con decimal"},{name:"invalidIntegerNumber",label:"Solo n\xfameros enteros"},{name:"matchstring",label:`${e.matchStringCustomLabel?e.matchStringCustomLabel:"El texto no coincide"}`}].find(e=>e.name==t)}static matchString(t,e=null){return i=>i.value?t==i.value?null:e?{matchstring:{requiredString:t,matchStringCustomLabel:e}}:{matchstring:t}:null}static CheckOnlyIntegerNumbers(t){return(null==t?void 0:t.value)?/^[0-9]+$/.test(null==t?void 0:t.value)?0==(null==t?void 0:t.value)?{invalidIntegerNumber:!0}:null:{invalidIntegerNumber:!0}:null}static CheckOnlyNumbers(t){return(null==t?void 0:t.value)?/^[1-9]\d*\.?\d*$/.test(null==t?void 0:t.value)?0==(null==t?void 0:t.value)?{invalidNumber:!0}:null:{invalidNumber:!0}:null}static EmailValidator(t){return(null==t?void 0:t.value.match(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/))?null:{invalidEmailAddress:!0}}static RfcValidator(t){return(null==t?void 0:t.value)&&(null==t?void 0:t.value.match(/^([A-Z\xd1&]{3,4}) ?(?:- ?)?(\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])) ?(?:- ?)?([A-Z\d]{2})([A\d])$/))?null:{invalidRFC:!0}}}return t.password="",t.confirmPassword="",t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},6304:(t,e,i)=>{"use strict";function n(t,e,i,n,r,s,o){try{var a=t[s](o),l=a.value}catch(c){return void i(c)}a.done?e(l):Promise.resolve(l).then(n,r)}function r(t){return function(){var e=this,i=arguments;return new Promise(function(r,s){var o=t.apply(e,i);function a(t){n(o,r,s,a,l,"next",t)}function l(t){n(o,r,s,a,l,"throw",t)}a(void 0)})}}i.d(e,{Z:()=>r})}}]);