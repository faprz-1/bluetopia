(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[9537],{7254:(t,e,i)=>{"use strict";i.d(e,{R:()=>a});var n=i(8318),s=i(8470),r=i(5024),o=i(9996);function a(t,e,i,c){return(0,r.m)(i)&&(c=i,i=void 0),c?a(t,e,i).pipe((0,o.U)(t=>(0,s.k)(t)?c(...t):c(t))):new n.y(n=>{l(t,e,function(t){n.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},n,i)})}function l(t,e,i,n,s){let r;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const n=t;t.addEventListener(e,i,s),r=()=>n.removeEventListener(e,i,s)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const n=t;t.on(e,i),r=()=>n.off(e,i)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const n=t;t.addListener(e,i),r=()=>n.removeListener(e,i)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let r=0,o=t.length;r<o;r++)l(t[r],e,i,n,s)}n.add(r)}},810:(t,e,i)=>{"use strict";i.d(e,{e:()=>l});var n=i(8569),s=i(6882);class r{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new o(t,this.durationSelector))}}class o extends s.Ds{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let i;try{const{durationSelector:e}=this;i=e(t)}catch(e){return this.destination.error(e)}const n=(0,s.ft)(i,new s.IY(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}clearThrottle(){const{value:t,hasValue:e,throttled:i}=this;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),e&&(this.value=void 0,this.hasValue=!1,this.destination.next(t))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}var a=i(1110);function l(t,e=n.P){return i=()=>(0,a.H)(t,e),function(t){return t.lift(new r(i))};var i}},5416:(t,e,i)=>{"use strict";i.d(e,{R:()=>s});var n=i(6882);function s(t){return e=>e.lift(new r(t))}class r{constructor(t){this.notifier=t}call(t,e){const i=new o(t),s=(0,n.ft)(this.notifier,new n.IY(i));return s&&!i.seenValue?(i.add(s),e.subscribe(i)):i}}class o extends n.Ds{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}},1741:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(8277);class s extends n.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(()=>t.flush(null))))}recycleAsyncId(t,e,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(t,e,i);0===t.actions.length&&(cancelAnimationFrame(e),t.scheduled=void 0)}}var r=i(1098);class o extends r.v{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let i,n=-1,s=e.length;t=t||e.shift();do{if(i=t.execute(t.state,t.delay))break}while(++n<s&&(t=e.shift()));if(this.active=!1,i){for(;++n<s&&(t=e.shift());)t.unsubscribe();throw i}}}const a=new o(s)},6158:(t,e,i)=>{"use strict";i.d(e,{w:()=>a});var n=i(5821),s=i(7368),r=i(1116);function o(t,e){if(1&t&&(s.TgZ(0,"div",1),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.hij(" ",null==t.errorMessage?null:t.errorMessage.label,"\n")}}let a=(()=>{class t{constructor(){}ngOnInit(){}get errorMessage(){var t,e,i,s;for(let r in null===(t=this.control)||void 0===t?void 0:t.errors)if((null===(e=this.control)||void 0===e?void 0:e.errors.hasOwnProperty(r))&&(null===(i=this.control)||void 0===i?void 0:i.touched))return n.R.GetValidatorErrorMessage(r,null===(s=this.control)||void 0===s?void 0:s.errors[r]);return null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-control-messages"]],inputs:{control:"control"},decls:1,vars:1,consts:[["class","color-red",4,"ngIf"],[1,"color-red"]],template:function(t,e){1&t&&s.YNc(0,o,2,1,"div",0),2&t&&s.Q6J("ngIf",null!==e.errorMessage)},directives:[r.O5],styles:[""]}),t})()},9130:(t,e,i)=>{"use strict";i.r(e),i.d(e,{VerificationModule:()=>y});var n=i(1116),s=i(2894),r=i(4391),o=i(1041),a=i(6050),l=i(9609),c=i(5821),u=i(7368),d=i(407),h=i(1392),g=i(6189),m=i(2874),p=i(8118),f=i(6158);function v(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"form",18),u.TgZ(1,"div",19),u.TgZ(2,"div",20),u._UZ(3,"img",21),u.qZA(),u.TgZ(4,"input",22),u.NdJ("input",function(){return u.CHM(t),u.oxw().OnPasswordChange()}),u.qZA(),u._UZ(5,"app-control-messages",23),u.qZA(),u.TgZ(6,"div",19),u.TgZ(7,"div",20),u._UZ(8,"img",21),u.qZA(),u._UZ(9,"input",24),u._UZ(10,"app-control-messages",23),u.qZA(),u.qZA()}if(2&t){const t=u.oxw();u.Q6J("formGroup",t.passwordForm),u.xp6(5),u.Q6J("control",t.passwordForm.get("password")),u.xp6(5),u.Q6J("control",t.passwordForm.get("confirmPassword"))}}function w(t,e){1&t&&(u.TgZ(0,"span"),u._uU(1,"Continuar"),u.qZA())}function b(t,e){1&t&&(u.TgZ(0,"span"),u._UZ(1,"i",25),u.qZA())}function Z(t,e){1&t&&(u.TgZ(0,"div",26),u._UZ(1,"i",27),u.qZA())}const S=[{path:"",component:(()=>{class t{constructor(t,e,i,n,s,r){this.nav=t,this.activatedRoute=e,this.api=i,this.toast=n,this.notiServ=s,this.pushService=r,this.loading={checkingCode:!1,updatingPassword:!1},this.teacher=null,this.activationToken=null,this.passwordForm=new o.cw({password:new o.NI("",[o.kI.required,o.kI.minLength(3)]),confirmPassword:new o.NI("",[o.kI.required,o.kI.minLength(3)])})}ngOnInit(){this.GetParams()}GetParams(){this.activatedRoute.params.subscribe(t=>{this.activationToken=t.activationToken,this.GetTeacher()})}GetTeacher(){this.loading.checkingCode=!0,this.api.Get(`/Teachers/ByActivationToken/${this.activationToken}`).subscribe(t=>{this.teacher=t,this.loading.checkingCode=!1},t=>{console.error("Error getting teacher",t),this.loading.checkingCode=!1,"invalid token"==t.error.error.message&&this.toast.ShowError("Este link ya ha expirado")})}OnPasswordChange(){var t,e;const i=null===(t=this.passwordForm.get("password"))||void 0===t?void 0:t.value;null===(e=this.passwordForm.get("confirmPassword"))||void 0===e||e.setValidators([o.kI.required,o.kI.minLength(3),c.R.matchString(i)])}SetPasswordAndLogin(){if(this.passwordForm.invalid)return this.toast.ShowWarning("Favor de llenar todos los campos correctamente"),void this.passwordForm.markAllAsTouched();let t=this.passwordForm.value;this.loading.updatingPassword=!0,this.api.Patch(`/Teachers/${this.teacher.id}/Activate`,{password:t.password}).subscribe(e=>{this.Login({email:this.teacher.email,password:t.password})},t=>{console.error("error activating teacher",t),this.loading.updatingPassword=!1})}Login(t){this.api.Post("/Usuarios/login",{email:t.email,password:t.password},!1).subscribe(t=>{localStorage.clear(),this.api.SetToken(t.id),this.api.Get("/Usuarios/withCredentials",!0).subscribe(t=>{localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("ttl",l().add(1209600,"s").toISOString()),this.notiServ.LoadNotifications(),this.pushService.GetUserID(),this.toast.ShowSuccess("Sesi\xf3n iniciada exitosamente");let e=this.api.GetUser().role.name.toLowerCase();this.loading.updatingPassword=!1,this.nav.GoTo(`/inicio/${e}/`)},t=>{this.loading.updatingPassword=!1,this.toast.ShowError(t.error.error.message)})},t=>{this.loading.updatingPassword=!1,this.toast.ShowError(t.error.error.message)})}}return t.\u0275fac=function(e){return new(e||t)(u.Y36(d.f),u.Y36(s.gz),u.Y36(h.sM),u.Y36(g.k),u.Y36(m.g),u.Y36(p._))},t.\u0275cmp=u.Xpm({type:t,selectors:[["app-verification"]],decls:24,vars:5,consts:[[1,"full-page"],[1,"d-flex","h-100"],["src","assets/img/landing_page_side.png","alt","Side img",1,"side-img"],[1,"w-100","vertical-content"],[1,"row","m-0"],[1,"col-12","text-center"],["src","assets/img/project_name.png","alt","Bluetopia",1,"title-img"],[1,"header-container"],[1,"title"],["src","assets/img/landing_page_img.png","alt","Image",1,"landing-image"],[1,"subtitle"],[1,"text-center"],["class","form-container",3,"formGroup",4,"ngIf","ngIfElse"],[1,"mt-5"],[1,"d-flex","justify-content-center"],[1,"btn","btn-outline-primary","btn-bigger",3,"disabled","click"],[4,"ngIf"],["bigLoading",""],[1,"form-container",3,"formGroup"],[1,"input-container"],[1,"input-icon-container","text-center"],["src","assets/icons/lock.png"],["type","password","placeholder","Contrase\xf1a","formControlName","password",1,"form-control",3,"input"],[3,"control"],["type","password","placeholder","Confirmar contrase\xf1a","formControlName","confirmPassword",1,"form-control"],[1,"zmdi","zmdi-spinner","zmdi-hc-2x","zmdi-hc-spin"],[1,"w-100","text-center"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"]],template:function(t,e){if(1&t&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u._UZ(2,"img",2),u.TgZ(3,"div",3),u.TgZ(4,"div",4),u.TgZ(5,"div",5),u.TgZ(6,"div"),u._UZ(7,"img",6),u.qZA(),u.TgZ(8,"div",7),u.TgZ(9,"div",8),u._uU(10," \xa1Bienvenido! "),u.qZA(),u.TgZ(11,"div"),u._UZ(12,"img",9),u.qZA(),u.TgZ(13,"div",10),u._uU(14," Para temrinar la creaci\xf3n de su cuenta porfavor ingrese una contrase\xf1a "),u.qZA(),u.qZA(),u.TgZ(15,"div",11),u.YNc(16,v,11,3,"form",12),u.qZA(),u.TgZ(17,"div",13),u.TgZ(18,"div",14),u.TgZ(19,"button",15),u.NdJ("click",function(){return e.SetPasswordAndLogin()}),u.YNc(20,w,2,0,"span",16),u.YNc(21,b,2,0,"span",16),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.YNc(22,Z,2,0,"ng-template",null,17,u.W1O)),2&t){const t=u.MAs(23);u.xp6(16),u.Q6J("ngIf",!e.loading.checkingCode)("ngIfElse",t),u.xp6(3),u.Q6J("disabled",e.loading.updatingPassword||e.loading.checkingCode),u.xp6(1),u.Q6J("ngIf",!e.loading.updatingPassword),u.xp6(1),u.Q6J("ngIf",e.loading.updatingPassword)}},directives:[n.O5,o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,f.w],styles:[".title[_ngcontent-%COMP%]{margin:1rem 0}.landing-image[_ngcontent-%COMP%]{margin:38px 0;max-height:150px}.header-container[_ngcontent-%COMP%]{max-width:500px;display:inline-block}.subtitle[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:500;color:#758ca6;margin-bottom:50px}.form-container[_ngcontent-%COMP%]{display:inline-block;max-width:500px;width:100%}"]}),t})()}];let y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[o.u5,n.ez,r.A0,o.UX,a.G,s.Bz.forChild(S)]]}),t})()},407:(t,e,i)=>{"use strict";i.d(e,{f:()=>o});var n=i(7368),s=i(2894),r=i(1392);let o=(()=>{class t{constructor(t,e){this.router=t,this.api=e,this.user=null,this.routes=[],this.routes=JSON.parse(localStorage.getItem("routes")||"[]")}HasInitialSlash(t){return!!t&&"/"==t.charAt(0)}GoToUserRoute(t){this.user=this.api.GetUser(),this.user&&(this.user&&this.user.role&&!t.includes(this.user.role.name.toLowerCase())?this.GoTo(`/inicio/${this.user.role.name.toLowerCase()}${this.HasInitialSlash(t)?"":"/"}${t}`):this.GoTo(`${this.HasInitialSlash(t)?"":"/"}${t}`))}GoTo(t){this.routes.push(this.GetUrlSnapshot()),this.SaveRoutes(),this.router.navigate([`${this.HasInitialSlash(t)?"":"/"}${t}`])}GoBack(){this.routes.length&&this.router.navigate([this.routes.pop()]),this.SaveRoutes()}ClearRoutes(){this.routes=[],this.SaveRoutes()}SaveRoutes(){localStorage.setItem("routes",JSON.stringify(this.routes))}GetUrlSnapshot(){return this.router.url}}return t.\u0275fac=function(e){return new(e||t)(n.LFG(s.F0),n.LFG(r.sM))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},2874:(t,e,i)=>{"use strict";i.d(e,{g:()=>o});var n=i(6304),s=i(7368),r=i(1392);let o=(()=>{class t{constructor(t){this.api=t,this.notifications=[]}Init(){this.LoadNotifications(),this.SusbcribeToNotifications()}SusbcribeToNotifications(){}LoadNotifications(t=!1){let e="/Notifications/getLast5";e+=t?"/"+t:"",this.api.Get(e).subscribe(t=>{this.notifications.push.apply(this.notifications,t)})}CountUnseen(){let t=0;return this.notifications.forEach(e=>{null==e.seen&&t++}),t}SetSeen(t){var e=this;return(0,n.Z)(function*(){if(null==t.seen){let i=yield e.api.Get("/Notifications/setSeen/"+t.id);e.notifications.forEach((t,n)=>{t.id==t.id&&(e.notifications[n]=i)})}})()}PrepareUrl(t){return t?t.split("/#")[1]:""}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(r.sM))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},5821:(t,e,i)=>{"use strict";i.d(e,{R:()=>s});var n=i(7368);let s=(()=>{class t{constructor(){}static GetValidatorErrorMessage(t,e){return[{name:"required",label:"Campo requerido"},{name:"invalidRFC",label:"No tiene el formato adecuado"},{name:"invalidEmailAddress",label:"Correo inv\xe1lido"},{name:"invalidPassword",label:"Las contrase\xf1as no coinciden"},{name:"minlength",label:`M\xednimo ${e.requiredLength} caracteres `},{name:"maxlength",label:`M\xe1ximo ${e.requiredLength} caracteres `},{name:"invalidNumber",label:"Solo n\xfameros enteros, o con decimal"},{name:"invalidIntegerNumber",label:"Solo n\xfameros enteros"},{name:"matchstring",label:`${e.matchStringCustomLabel?e.matchStringCustomLabel:"El texto no coincide"}`}].find(e=>e.name==t)}static matchString(t,e=null){return i=>i.value?t==i.value?null:e?{matchstring:{requiredString:t,matchStringCustomLabel:e}}:{matchstring:t}:null}static CheckOnlyIntegerNumbers(t){return(null==t?void 0:t.value)?/^[0-9]+$/.test(null==t?void 0:t.value)?0==(null==t?void 0:t.value)?{invalidIntegerNumber:!0}:null:{invalidIntegerNumber:!0}:null}static CheckOnlyNumbers(t){return(null==t?void 0:t.value)?/^[1-9]\d*\.?\d*$/.test(null==t?void 0:t.value)?0==(null==t?void 0:t.value)?{invalidNumber:!0}:null:{invalidNumber:!0}:null}static EmailValidator(t){return(null==t?void 0:t.value.match(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/))?null:{invalidEmailAddress:!0}}static RfcValidator(t){return(null==t?void 0:t.value)&&(null==t?void 0:t.value.match(/^([A-Z\xd1&]{3,4}) ?(?:- ?)?(\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])) ?(?:- ?)?([A-Z\d]{2})([A\d])$/))?null:{invalidRFC:!0}}}return t.password="",t.confirmPassword="",t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},6304:(t,e,i)=>{"use strict";function n(t,e,i,n,s,r,o){try{var a=t[r](o),l=a.value}catch(c){return void i(c)}a.done?e(l):Promise.resolve(l).then(n,s)}function s(t){return function(){var e=this,i=arguments;return new Promise(function(s,r){var o=t.apply(e,i);function a(t){n(o,s,r,a,l,"next",t)}function l(t){n(o,s,r,a,l,"throw",t)}a(void 0)})}}i.d(e,{Z:()=>s})}}]);