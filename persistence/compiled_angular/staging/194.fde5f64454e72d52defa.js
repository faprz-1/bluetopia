(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[194],{2194:(e,t,n)=>{"use strict";n.r(t),n.d(t,{StrategyTeamsRolesModule:()=>M});var o=n(1116),s=n(2894),i=n(4391),r=n(1041),a=n(6050),l=n(5470),c=n(6304),g=n(5959),m=n(7368),u=n(1392),p=n(407),d=n(4792);function f(e,t){if(1&e&&(m.TgZ(0,"div",14),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.hij(" ",e.name," ")}}function h(e,t){if(1&e&&(m.ynx(0),m.TgZ(1,"div",34),m.TgZ(2,"span"),m._uU(3),m.qZA(),m.qZA(),m.BQk()),2&e){const e=t.$implicit,n=m.oxw(3);m.xp6(3),m.hij(" ",n.BuildStudentFullName(e.student)," ")}}function x(e,t){if(1&e&&(m.TgZ(0,"ng-option",38),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.Q6J("value",e.id),m.xp6(1),m.Oqu(e.name?e.name:e)}}function v(e,t){if(1&e){const e=m.EpF();m.ynx(0),m.TgZ(1,"div",35),m.TgZ(2,"ng-select",36),m.NdJ("change",function(){return m.CHM(e),m.oxw(3).saver.next()})("ngModelChange",function(e){return t.$implicit.roleId=e}),m.YNc(3,x,2,2,"ng-option",37),m.qZA(),m.qZA(),m.BQk()}if(2&e){const e=t.$implicit,n=m.oxw(3);m.xp6(2),m.Q6J("ngModel",e.roleId),m.xp6(1),m.Q6J("ngForOf",n.roleOptions)}}function Z(e,t){if(1&e&&(m.TgZ(0,"div",30),m.TgZ(1,"div",31),m.TgZ(2,"div",32),m.YNc(3,h,4,1,"ng-container",33),m.qZA(),m.TgZ(4,"div",32),m.YNc(5,v,4,2,"ng-container",33),m.qZA(),m.qZA(),m.qZA()),2&e){const e=m.oxw().$implicit;m.xp6(3),m.Q6J("ngForOf",e.members),m.xp6(2),m.Q6J("ngForOf",e.members)}}function b(e,t){if(1&e&&(m.TgZ(0,"div",26),m.TgZ(1,"div",27),m.TgZ(2,"div",28),m._uU(3),m.qZA(),m.YNc(4,Z,6,2,"div",29),m.qZA(),m.qZA()),2&e){const e=t.$implicit;m.xp6(3),m.Oqu(e.name),m.xp6(1),m.Q6J("ngIf",!(null==e||null==e.members||!e.members.length))}}let T=(()=>{class e{constructor(e,t,n){this.activatedRoute=e,this.api=t,this.nav=n,this.roles=[],this.customRoles=[],this.roleOptions=[],this.strategyTeams=[],this.rolesToUse="default",this.saver=new g.xQ,this.saving=!1,this.crumbs=[{name:"Equipos",route:null},{name:"Asigna roles a tus alumnos",route:null}]}get rolesText(){return this.roles.map(e=>e.name).join(" / ")}ngOnInit(){this.saver.subscribe(()=>{this.SaveAll()}),this.GetRoles(),this.GetParams()}BuildStudentFullName(e){return`${e.name} ${e.fatherLastname} ${e.motherLastname}`}AddCustomRole(e){e&&this.api.Post("/TeamRoles",{role:{name:e,strategyId:this.strategyId}}).subscribe(e=>{this.customRoles.push(e)})}GetParams(){this.activatedRoute.params.subscribe(e=>{this.strategyId=e.strategyId,this.GetStrategy()})}SaveAll(e=!1){var t=this;return(0,c.Z)(function*(){if(!t.saving)try{t.saving=!0,t.SaveStrategy(),yield t.SaveStrategyTeams(),t.saving=!1,e&&t.nav.GoToUserRoute(`mis-estrategias/${t.strategyId}/progreso-equipos`)}catch(n){console.error("Error saving changes",n),t.saving=!1}})()}GetRoles(){this.api.Get("/TeamRoles").subscribe(e=>{this.roles=e,this.roleOptions=Array.from(e)})}GetStrategy(){this.api.Get(`/Strategies/${this.strategyId}`).subscribe(e=>{var t,n;this.strategy=e,this.rolesToUse=e.useCustomRoles?"custom":"default",(null===(t=e.teams)||void 0===t?void 0:t.length)&&(this.strategyTeams=e.teams),(null===(n=e.customRoles)||void 0===n?void 0:n.length)&&(this.customRoles=e.customRoles)},e=>{console.error("Error getting strategy",e)})}SaveStrategy(){return new Promise((e,t)=>{this.api.Patch(`/Strategies/${this.strategyId}/OnlyStrategy/1`,{strategy:{id:this.strategyId,useCustomRoles:"custom"==this.rolesToUse}}).subscribe(t=>{e()},e=>{console.error("Error saving strategy",e),t(e)})})}SaveStrategyTeams(){return new Promise((e,t)=>{this.api.Patch("/Teams/MemebersRoles",{teams:this.strategyTeams}).subscribe(t=>{e()},e=>{console.error("Error patching teams",e),t(e)})})}OnRolesToUseChange(){switch(this.rolesToUse){case"default":this.roleOptions=this.roles;break;case"custom":this.roleOptions=this.customRoles}this.saver.next()}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(s.gz),m.Y36(u.sM),m.Y36(p.f))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-strategy-teams-roles"]],decls:40,vars:5,consts:[[1,"content"],[1,"d-flex","justify-content-between","flex-wrap"],[3,"crumbs"],[1,"d-flex"],[1,"d-flex","flex-column","mt-5",2,"gap","13px"],[1,"form-row"],[1,"instruction-number"],[1,"form-col"],[1,"form-section-title"],[1,"d-flex","flex-column","align-items-start","align-self-stretch",2,"gap","12px"],[1,"d-flex","flex-column","align-items-start",2,"gap","12px"],["for","isByTeamsYes",1,"m-0","checkbox-label"],["type","radio","id","isByTeamsYes","name","isByTeams","value","default",1,"checkbox-input",3,"ngModel","ngModelChange","change"],[1,"checkbox-custom"],[1,"fake-input-disabled"],["for","isByTeamsNo",1,"m-0","checkbox-label"],["type","radio","id","isByTeamsNo","name","isByTeams","value","custom",1,"checkbox-input",3,"ngModel","ngModelChange","change"],[1,"d-flex","align-items-center","flex-wrap",2,"gap","12px"],["class","fake-input-disabled",4,"ngFor","ngForOf"],[1,"input-container","mb-0",2,"width","270px"],["type","text","placeholder","Escribe los roles que consideres",1,"form-control","no-icon","with-border"],["customRoleInput",""],["src","assets/icons/add-circle-success.svg",1,"clickeable",3,"click"],[1,"row","align-self-stretch"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[1,"btn","align-self-end","btn-primary",3,"click"],[1,"col-12","col-md-6"],[1,"team-container","w-100"],[1,"title","mb-0"],["class","team w-100",4,"ngIf"],[1,"team","w-100"],[1,"d-flex","w-100",2,"gap","10px"],[1,"d-flex","flex-column","w-50",2,"gap","10px"],[4,"ngFor","ngForOf"],[1,"member"],[1,"w-100"],["placeholder","Roles",1,"form-control","align-self-stretch",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",0),m.TgZ(1,"div",1),m._UZ(2,"app-breadcrumb",2),m._UZ(3,"div",3),m.qZA(),m.TgZ(4,"div",4),m.TgZ(5,"div",5),m.TgZ(6,"span",6),m._uU(7,"1"),m.qZA(),m.TgZ(8,"div",7),m.TgZ(9,"div",8),m._uU(10," Selecciona los roles a asignar "),m.qZA(),m.TgZ(11,"div",9),m.TgZ(12,"div",10),m.TgZ(13,"label",11),m._uU(14," Usar recomendados "),m.TgZ(15,"input",12),m.NdJ("ngModelChange",function(e){return t.rolesToUse=e})("change",function(){return t.OnRolesToUseChange()}),m.qZA(),m._UZ(16,"span",13),m.qZA(),m.TgZ(17,"div",14),m._uU(18," Lider/Creativo/Cronometro/Redactor "),m.qZA(),m.qZA(),m.TgZ(19,"div",9),m.TgZ(20,"label",15),m._uU(21," Usar mis roles "),m.TgZ(22,"input",16),m.NdJ("ngModelChange",function(e){return t.rolesToUse=e})("change",function(){return t.OnRolesToUseChange()}),m.qZA(),m._UZ(23,"span",13),m.qZA(),m.TgZ(24,"div",17),m.YNc(25,f,2,1,"div",18),m.TgZ(26,"div",19),m._UZ(27,"input",20,21),m.qZA(),m.TgZ(29,"img",22),m.NdJ("click",function(){m.CHM(e);const n=m.MAs(28);return t.AddCustomRole(n.value),n.value=""}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(30,"div",5),m.TgZ(31,"span",6),m._uU(32,"2"),m.qZA(),m.TgZ(33,"div",7),m.TgZ(34,"div",8),m._uU(35," Asigna roles a tus alumnos en los equipos "),m.qZA(),m.TgZ(36,"div",23),m.YNc(37,b,5,2,"div",24),m.qZA(),m.qZA(),m.qZA(),m.TgZ(38,"button",25),m.NdJ("click",function(){return t.SaveAll(!0)}),m._uU(39," Continuar "),m.qZA(),m.qZA(),m.qZA()}2&e&&(m.xp6(2),m.Q6J("crumbs",t.crumbs),m.xp6(13),m.Q6J("ngModel",t.rolesToUse),m.xp6(7),m.Q6J("ngModel",t.rolesToUse),m.xp6(3),m.Q6J("ngForOf",t.customRoles),m.xp6(12),m.Q6J("ngForOf",t.strategyTeams))},directives:[d.L,r._,r.Fj,r.JJ,r.On,o.sg,o.O5,i.w9,i.xv],styles:['@charset "UTF-8";.instruction-number[_ngcontent-%COMP%]{margin-top:3px;color:var(--green-1,#26d7a4);font-size:24px;font-family:Mulish;font-weight:900}.form-row[_ngcontent-%COMP%]{flex-wrap:nowrap;width:100%}.form-row[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]{display:flex;align-items:flex-start;grid-gap:12px;gap:12px}.form-row[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]{flex-grow:1;flex-direction:column}.form-row[_ngcontent-%COMP%]   .form-section-instruction[_ngcontent-%COMP%]{font-size:16px}.form-row[_ngcontent-%COMP%]   .form-section-instruction[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]   .form-section-title[_ngcontent-%COMP%]{color:var(--gray-1,#3d5e81);font-family:Mulish;font-style:normal;font-weight:500;line-height:normal}.form-row[_ngcontent-%COMP%]   .form-section-title[_ngcontent-%COMP%]{display:flex;align-items:flex-start;grid-gap:12px;gap:12px;font-size:20px}.checkbox-input[_ngcontent-%COMP%]{display:none}.checkbox-label[_ngcontent-%COMP%]{display:inline-block;position:relative;padding-left:30px;cursor:pointer;font-size:16px}.checkbox-custom[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:20px;height:20px;border:2px solid #2369b5;background-color:#fff;border-radius:3px}.checkbox-input[_ngcontent-%COMP%]:checked + .checkbox-custom[_ngcontent-%COMP%]:after{content:"\u2713";font-size:18px;color:#2369b5;position:absolute;top:50%;left:50%;transform:translateX(-50%) translateY(-50%)}.fake-input-disabled[_ngcontent-%COMP%]{display:flex;height:43px;padding:6px 24px;align-items:center;grid-gap:10px;gap:10px;border-radius:6px;border:1px solid var(--gray-1,#3d5e81);background:#f6f7f8;color:var(--gray-1,#3d5e81);text-align:center;font-family:Mulish;font-size:16px;font-style:normal;font-weight:500;line-height:normal}.team-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;grid-gap:12px;gap:12px}.team-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:20px}.team-container[_ngcontent-%COMP%]   .team[_ngcontent-%COMP%], .team-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--gray-1,#3d5e81);font-family:Mulish;font-style:normal;font-weight:500;line-height:normal}.team-container[_ngcontent-%COMP%]   .team[_ngcontent-%COMP%]{display:flex;padding:12px;flex-direction:column;align-items:flex-start;grid-gap:10px;gap:10px;border-radius:12px;background:var(--gray-3,#c1ccd7);text-align:center;font-size:16px}.team-container[_ngcontent-%COMP%]   .team[_ngcontent-%COMP%]   .member[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;align-self:stretch;justify-content:flex-start;align-items:center;height:48px;padding:6px 24px;border-radius:6px;background-color:#f6f7f8}.team-container[_ngcontent-%COMP%]   .team[_ngcontent-%COMP%]   .member[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}']}),e})();var y=n(5709);const O=[{path:"",component:T}];let M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[r.u5,o.ez,i.A0,y.w,r.UX,a.G,l.zk.forRoot(),s.Bz.forChild(O)]]}),e})()}}]);