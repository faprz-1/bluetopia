(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[572],{6211:(e,t,i)=>{"use strict";i.d(t,{p:()=>g});var n=i(7368),o=i(1392),r=i(5470),a=i(1116);const s=["libraryFileSelectorModal"],c=function(e){return{selected:e}};function l(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",12),n.NdJ("click",function(){const t=n.CHM(e).$implicit;return n.oxw().ToggleFile(t)}),n._UZ(1,"i",13),n._uU(2),n.qZA()}if(2&e){const e=t.$implicit;n.Q6J("ngClass",n.VKq(2,c,e.selected)),n.xp6(2),n.hij(" ",e.name," ")}}const d=function(){return{backdrop:"static",keyboard:!1}};let g=(()=>{class e{constructor(e){this.api=e,this.onFilesSelectd=new n.vpe,this.user=null,this.files=[]}ngOnInit(){this.user=this.api.GetUser(),this.GetLibraryFiles()}OpenModal(){var e;null===(e=this.modal)||void 0===e||e.show()}CloseModal(){var e;null===(e=this.modal)||void 0===e||e.hide()}GetLibraryFiles(){this.api.Get(`/Usuarios/${this.user.schoolId}/FileLibrary`).subscribe(e=>{this.files=e},e=>{console.error("Error getting the files",e)})}ToggleFile(e){e.selected=!e.selected}SelectFiles(){this.onFilesSelectd.emit(this.files.filter(e=>e.selected))}Reset(){this.files.forEach(e=>e.selected=!1)}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(o.sM))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-library-file-selector-modal"]],viewQuery:function(e,t){if(1&e&&n.Gf(s,5),2&e){let e;n.iGM(e=n.CRH())&&(t.modal=e.first)}},outputs:{onFilesSelectd:"onFilesSelectd"},decls:15,vars:3,consts:[["bsModal","","tabindex","-1","role","dialog","aria-labelledby","libraryFileSelectorModal",1,"modal","fade",3,"config"],["libraryFileSelectorModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-body"],[1,"text","text-center"],[1,"files"],["class","file clickeable",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"modal-footer","justify-content-around"],[1,"btn","btn-bigger","btn-outline-primary","modal-btn",3,"click"],[1,"btn","btn-bigger","btn-primary","modal-btn",3,"click"],[1,"file","clickeable",3,"ngClass","click"],[1,"zmdi","zmdi-file","zmdi-hc-2x","mr-3"]],template:function(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",0,1),n.TgZ(2,"div",2),n.TgZ(3,"div",3),n._UZ(4,"div",4),n.TgZ(5,"div",5),n.TgZ(6,"div",6),n._uU(7," Selecciona los archivos que deseas adjuntar "),n.qZA(),n.TgZ(8,"div",7),n.YNc(9,l,3,4,"div",8),n.qZA(),n.qZA(),n.TgZ(10,"div",9),n.TgZ(11,"button",10),n.NdJ("click",function(){return n.CHM(e),n.MAs(1).hide(),t.Reset()}),n._uU(12," Cancelar "),n.qZA(),n.TgZ(13,"button",11),n.NdJ("click",function(){n.CHM(e);const i=n.MAs(1);return t.SelectFiles(),i.hide()}),n._uU(14," Aceptar "),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()}2&e&&(n.Q6J("config",n.DdM(2,d)),n.xp6(9),n.Q6J("ngForOf",t.files))},directives:[r.oB,a.sg,a.mk],styles:[".files[_ngcontent-%COMP%]{display:flex;width:100%;flex-wrap:wrap;max-height:50vh;overflow-y:auto}.files[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.8rem 1.2rem;margin:.5rem;flex-grow:1;border-radius:12px;border:2px solid #587594}.selected[_ngcontent-%COMP%]{border:4px solid #1081fb!important}"]}),e})()},5110:(e,t,i)=>{"use strict";i.d(t,{N:()=>l});var n=i(1116),o=i(4391),r=i(1041),a=i(6050),s=i(5470),c=(i(6211),i(7368));let l=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[r.u5,n.ez,o.A0,r.UX,a.G,s.zk.forRoot()]]}),e})()},572:(e,t,i)=>{"use strict";i.r(t),i.d(t,{CreateActivityModule:()=>T});var n=i(1116),o=i(2894),r=i(4391),a=i(1041),s=i(6050),c=i(5470),l=i(5110),d=i(193),g=i(9355),f=i(529),u=i(7368),m=i(1392),p=i(407),h=i(6189),v=i(6211);function Z(e,t){1&e&&(u.TgZ(0,"div",32),u._UZ(1,"img",33),u._UZ(2,"img",34),u._UZ(3,"img",35),u.qZA())}function x(e,t){if(1&e&&(u.TgZ(0,"div",38),u._UZ(1,"i",39),u._uU(2),u.qZA()),2&e){const e=t.$implicit;u.xp6(2),u.hij(" ",e.name," ")}}function b(e,t){if(1&e&&(u.TgZ(0,"div",36),u.YNc(1,x,3,1,"div",37),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngForOf",e.GetFiles("new"))}}function y(e,t){1&e&&(u.TgZ(0,"div",32),u._UZ(1,"img",40),u._UZ(2,"img",41),u._UZ(3,"img",42),u.qZA())}function C(e,t){if(1&e&&(u.TgZ(0,"div",38),u._UZ(1,"i",39),u._uU(2),u.qZA()),2&e){const e=t.$implicit;u.xp6(2),u.hij(" ",e.name," ")}}function _(e,t){if(1&e&&(u.TgZ(0,"div",36),u.YNc(1,C,3,1,"div",37),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngForOf",e.GetFiles("old"))}}function A(e,t){1&e&&(u.TgZ(0,"span"),u._uU(1,"Continuar"),u.qZA())}function M(e,t){1&e&&(u.TgZ(0,"span"),u._UZ(1,"i",43),u.qZA())}const w=function(){return{adaptivePosition:!0,containerClass:"theme-dark-blue"}},q=[{path:"",component:(()=>{class e{constructor(e,t,i,n){this.api=e,this.nav=t,this.activatedRoute=i,this.toast=n,this.activities=[],this.loading=!1,this.canContinue=!0,this.activityForm=new a.cw({name:new a.NI(null,[a.kI.required]),instructions:new a.NI(null,[a.kI.required]),date:new a.NI(null,[a.kI.required]),strategyId:new a.NI(null,[a.kI.required]),resources:new a.NI([],[]),maxCalification:new a.NI([],[a.kI.required])})}get formatedDate(){return this.date?g(this.date).format("DD/MM/YY"):""}ngOnInit(){this.GetParams()}IsANumber(e){isNaN(Number(e))?(this.toast.ShowError("Solo valores num\xe9ricos"),this.canContinue=!1):this.canContinue=!0}ThatDateAlreadyPassed(e){let t=g(e[0]),i=g();t.isBefore(i,"day")?(this.toast.ShowError("La fecha proporcionada ya ha pasado, por favor elija otra fecha"),this.canContinue=!1):this.canContinue=!0}GetParams(){this.activatedRoute.params.subscribe(e=>{var t,i;this.strategyId=e.strategyId,this.date=e.date,null===(t=this.activityForm.get("date"))||void 0===t||t.setValue(new Date(g(this.date).toISOString())),null===(i=this.activityForm.get("strategyId"))||void 0===i||i.setValue(this.strategyId)})}GoBack(){this.nav.GoToUserRoute(`mis-estrategias/${this.strategyId}/calendario/${this.date}`)}OnFileSelected(e){Array.from(e.target.files).forEach(e=>{const t=new FileReader;t.onload=t=>{var i,n;let o={encodedFileContainer:"resources",base64File:btoa(t.target.result),name:e.name,resize:!1,fileExtention:"."+(null===(i=e.name.split(".").pop())||void 0===i?void 0:i.toLowerCase())};null===(n=this.activityForm.get("resources"))||void 0===n||n.value.push(o)},t.readAsBinaryString(e)})}OnLibraryFilesSelected(e){var t,i;null===(t=this.activityForm.get("resources"))||void 0===t||t.setValue(null===(i=this.activityForm.get("resources"))||void 0===i?void 0:i.value.concat(e))}SaveActivity(){if(this.activityForm.invalid)return this.toast.ShowWarning("Favor de llenar todos los campos"),void this.activityForm.markAllAsTouched();this.loading=!0;let e=Object.assign(Object.assign({},this.activityForm.value),{date:g(this.activityForm.value.date).tz(f.N.timeZone).toISOString(),strategyId:this.strategyId,isActivity:!0});this.api.Post("/ParcialProducts/activity",e).subscribe(e=>{this.loading=!1,this.toast.ShowSuccess("Evento creado correctamente"),this.GoBack()},e=>{console.error("Error creating event",e),this.loading=!1})}GetFiles(e){var t,i;switch(e){case"new":return null===(t=this.activityForm.get("resources"))||void 0===t?void 0:t.value.filter(e=>!e.id);case"old":return null===(i=this.activityForm.get("resources"))||void 0===i?void 0:i.value.filter(e=>!!e.id);default:return[]}}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(m.sM),u.Y36(p.f),u.Y36(o.gz),u.Y36(h.k))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-create-activity"]],decls:65,vars:11,consts:[[1,"content"],[1,"row-header"],[1,"title"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"back-section"],["src","assets/icons/back-arrow.png","alt","back-arrow",1,"back-icon","clickeable",3,"click"],[1,"event-date"],[1,"form-container",3,"formGroup"],[1,"form-row"],[1,"instruction-number"],[1,"form-col"],[1,"form-section-title"],[1,"input-container","with-border-thin"],["type","text","placeholder","T\xedtulo","formControlName","name",1,"form-control","no-icon"],[1,"input-container"],["formControlName","instructions","placeholder","Instrucciones de la actividad","rows","6",1,"form-control","with-border-thin"],["type","text","placeholder","Calificaci\xf3n m\xe1xima","formControlName","maxCalification",1,"form-control","no-icon",3,"ngModelChange"],["type","text","formControlName","date","placeholder","Fecha","bsDatepicker","",1,"form-control","no-icon","with-border",3,"bsConfig","bsValueChange"],["parcialProductDatePicker","bsDatepicker"],[1,"flex-files-container"],[1,"flex-files"],["class","flex-icons",4,"ngIf"],["class","flex-resources",4,"ngIf"],["type","file","multiple","",1,"d-none",3,"change"],["fileInput",""],[1,"btn","btn-success","btn-block",3,"click"],[1,"flex-files","mr-0"],[1,"d-flex","justify-content-end","my-4"],[1,"btn","btn-primary","btn-bigger",3,"disabled","click"],[4,"ngIf"],[3,"onFilesSelectd"],["libraryModal",""],[1,"flex-icons"],["src","assets/icons/video-recorder.png","alt","video"],["src","assets/icons/gallery.png","alt","video"],["src","assets/icons/book-closed-green.png","alt","video"],[1,"flex-resources"],["class","resource",4,"ngFor","ngForOf"],[1,"resource"],[1,"zmdi","zmdi-file","zmdi-hc-2x","text-primary","mr-3"],["src","assets/icons/library.png","alt","video"],["src","assets/icons/movie.png","alt","video"],["src","assets/icons/microscope.png","alt","video"],[1,"zmdi","zmdi-spinner","zmdi-hc-lg","zmdi-hc-spin"]],template:function(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",0),u.TgZ(1,"div",1),u._UZ(2,"div"),u.TgZ(3,"div",2),u._uU(4," Calendario "),u.qZA(),u._UZ(5,"div"),u.qZA(),u.TgZ(6,"div",3),u.TgZ(7,"div",4),u.TgZ(8,"img",5),u.NdJ("click",function(){return t.GoBack()}),u.qZA(),u.qZA(),u.TgZ(9,"div",6),u._uU(10),u.qZA(),u._UZ(11,"div"),u.qZA(),u.TgZ(12,"form",7),u.TgZ(13,"div",8),u.TgZ(14,"span",9),u._uU(15,"1"),u.qZA(),u.TgZ(16,"div",10),u.TgZ(17,"div",11),u._uU(18," Escribe un nombre para tu actividad "),u.qZA(),u.TgZ(19,"div",12),u._UZ(20,"input",13),u.qZA(),u.qZA(),u.qZA(),u.TgZ(21,"div",8),u.TgZ(22,"span",9),u._uU(23,"2"),u.qZA(),u.TgZ(24,"div",10),u.TgZ(25,"div",11),u._uU(26," Escribe las instrucciones "),u.qZA(),u.TgZ(27,"div",14),u._UZ(28,"textarea",15),u.qZA(),u.qZA(),u.qZA(),u.TgZ(29,"div",8),u.TgZ(30,"span",9),u._uU(31,"3"),u.qZA(),u.TgZ(32,"div",10),u.TgZ(33,"div",11),u._uU(34," Escribe la calificaci\xf3n m\xe1xima "),u.qZA(),u.TgZ(35,"div",12),u.TgZ(36,"input",16),u.NdJ("ngModelChange",function(){let e;return t.IsANumber(null==(e=t.activityForm.get("maxCalification"))?null:e.value)}),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(37,"div",8),u.TgZ(38,"span",9),u._uU(39,"4"),u.qZA(),u.TgZ(40,"div",10),u.TgZ(41,"div",11),u._uU(42," Selecciona la fecha "),u.qZA(),u.TgZ(43,"div",14),u.TgZ(44,"input",17,18),u.NdJ("bsValueChange",function(e){return t.ThatDateAlreadyPassed([e])}),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(46,"div",19),u.TgZ(47,"div",20),u.YNc(48,Z,4,0,"div",21),u.YNc(49,b,2,1,"div",22),u.TgZ(50,"input",23,24),u.NdJ("change",function(e){return t.OnFileSelected(e)}),u.qZA(),u.TgZ(52,"button",25),u.NdJ("click",function(){return u.CHM(e),u.MAs(51).click()}),u._uU(53," Adjuntar alg\xfan recurso "),u.qZA(),u.qZA(),u.TgZ(54,"div",26),u.YNc(55,y,4,0,"div",21),u.YNc(56,_,2,1,"div",22),u.TgZ(57,"button",25),u.NdJ("click",function(){return u.CHM(e),u.MAs(64).OpenModal()}),u._uU(58," Adjuntar de la biblioteca "),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(59,"div",27),u.TgZ(60,"button",28),u.NdJ("click",function(){return t.SaveActivity()}),u.YNc(61,A,2,0,"span",29),u.YNc(62,M,2,0,"span",29),u.qZA(),u.qZA(),u.qZA(),u.TgZ(63,"app-library-file-selector-modal",30,31),u.NdJ("onFilesSelectd",function(e){return t.OnLibraryFilesSelected(e)}),u.qZA()}2&e&&(u.xp6(10),u.hij(" ",t.formatedDate," "),u.xp6(2),u.Q6J("formGroup",t.activityForm),u.xp6(32),u.Q6J("bsConfig",u.DdM(10,w)),u.xp6(4),u.Q6J("ngIf",!t.GetFiles("new").length),u.xp6(1),u.Q6J("ngIf",!!t.GetFiles("new").length),u.xp6(6),u.Q6J("ngIf",!t.GetFiles("old").length),u.xp6(1),u.Q6J("ngIf",!!t.GetFiles("old").length),u.xp6(4),u.Q6J("disabled",0==t.canContinue),u.xp6(1),u.Q6J("ngIf",!t.loading),u.xp6(1),u.Q6J("ngIf",t.loading))},directives:[a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,d.Y5,d.Np,n.O5,v.p,n.sg],styles:[".title[_ngcontent-%COMP%]{color:#26d7a4}.subtitle[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:500;color:#587594;margin-bottom:.75rem}.event-date[_ngcontent-%COMP%]{width:155px;height:40px;flex-direction:column;justify-content:center;grid-gap:10px;gap:10px;flex-shrink:0;border-radius:6px 6px 0 0;background:var(--green-1,#26d7a4);color:#fff;font-family:Mulish;font-size:28px;font-style:normal;font-weight:700;line-height:normal}.event-date[_ngcontent-%COMP%], .flex-row[_ngcontent-%COMP%]{display:flex;align-items:center}.flex-row[_ngcontent-%COMP%]{justify-content:space-between;margin-bottom:.75rem}.flex-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:1.5rem!important}.flex-files-container[_ngcontent-%COMP%]{display:flex}.flex-files[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;width:335px;margin:0 3rem 3rem 0}.flex-files[_ngcontent-%COMP%], .flex-icons[_ngcontent-%COMP%]{display:flex;align-items:center}.flex-icons[_ngcontent-%COMP%]{justify-content:space-around;height:100%}.flex-icons[_ngcontent-%COMP%], .flex-resources[_ngcontent-%COMP%]{width:100%;margin-bottom:1.25rem}.flex-resources[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.flex-resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.4rem}.btn-bigger[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:800;padding:1rem 8rem}@media (min-width:0px) and (max-width:925px){.flex-files-container[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.flex-files[_ngcontent-%COMP%]{margin-right:0;width:100%;max-width:335px}}@media (min-width:0px) and (max-width:550px){.flex-row[_ngcontent-%COMP%]{flex-direction:column!important}.w-75[_ngcontent-%COMP%]{width:100%!important}}.form-container[_ngcontent-%COMP%]{display:inline-flex;padding:12px 24px;flex-direction:column;align-items:flex-start;grid-gap:24px;gap:24px;background:#f6f7f8}.form-container[_ngcontent-%COMP%]   .instruction-number[_ngcontent-%COMP%]{margin-top:3px;color:var(--green-1,#26d7a4);font-size:24px;font-family:Mulish;font-weight:900}.form-container[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;grid-gap:12px;gap:12px;width:100%}.form-container[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]{display:flex;flex-grow:1;flex-direction:column;grid-gap:12px;gap:12px;align-items:flex-start}.form-container[_ngcontent-%COMP%]   .form-section-instruction[_ngcontent-%COMP%]{font-size:16px}.form-container[_ngcontent-%COMP%]   .form-section-instruction[_ngcontent-%COMP%], .form-container[_ngcontent-%COMP%]   .form-section-title[_ngcontent-%COMP%]{color:var(--gray-1,#3d5e81);font-family:Mulish;font-style:normal;font-weight:500;line-height:normal}.form-container[_ngcontent-%COMP%]   .form-section-title[_ngcontent-%COMP%]{display:flex;align-items:flex-start;grid-gap:12px;gap:12px;font-size:20px}.input-container[_ngcontent-%COMP%]{margin:0}"]}),e})()}];let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[a.u5,n.ez,r.A0,a.UX,s.G,c.zk.forRoot(),d.kn.forRoot(),l.N,o.Bz.forChild(q)]]}),e})()}}]);