(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[130],{6158:(e,t,i)=>{"use strict";i.d(t,{w:()=>a});var r=i(5821),n=i(7368),o=i(1116);function s(e,t){if(1&e&&(n.TgZ(0,"div",1),n._uU(1),n.qZA()),2&e){const e=n.oxw();n.xp6(1),n.hij(" ",null==e.errorMessage?null:e.errorMessage.label,"\n")}}let a=(()=>{class e{constructor(){}ngOnInit(){}get errorMessage(){var e,t,i,n;for(let o in null===(e=this.control)||void 0===e?void 0:e.errors)if((null===(t=this.control)||void 0===t?void 0:t.errors.hasOwnProperty(o))&&(null===(i=this.control)||void 0===i?void 0:i.touched))return r.R.GetValidatorErrorMessage(o,null===(n=this.control)||void 0===n?void 0:n.errors[o]);return null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-control-messages"]],inputs:{control:"control"},decls:1,vars:1,consts:[["class","color-red",4,"ngIf"],[1,"color-red"]],template:function(e,t){1&e&&n.YNc(0,s,2,1,"div",0),2&e&&n.Q6J("ngIf",null!==t.errorMessage)},directives:[o.O5],styles:[""]}),e})()},9130:(e,t,i)=>{"use strict";i.r(t),i.d(t,{VerificationModule:()=>T});var r=i(1116),n=i(2320),o=i(4391),s=i(1041),a=i(6050),l=i(9609),c=i(5821),d=i(7368),u=i(407),g=i(1392),m=i(6189),h=i(2874),p=i(8118),v=i(6158);function w(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"form",18),d.TgZ(1,"div",19),d.TgZ(2,"div",20),d._UZ(3,"img",21),d.qZA(),d.TgZ(4,"input",22),d.NdJ("input",function(){return d.CHM(e),d.oxw().OnPasswordChange()}),d.qZA(),d._UZ(5,"app-control-messages",23),d.qZA(),d.TgZ(6,"div",19),d.TgZ(7,"div",20),d._UZ(8,"img",21),d.qZA(),d._UZ(9,"input",24),d._UZ(10,"app-control-messages",23),d.qZA(),d.qZA()}if(2&e){const e=d.oxw();d.Q6J("formGroup",e.passwordForm),d.xp6(5),d.Q6J("control",e.passwordForm.get("password")),d.xp6(5),d.Q6J("control",e.passwordForm.get("confirmPassword"))}}function f(e,t){1&e&&(d.TgZ(0,"span"),d._uU(1,"Continuar"),d.qZA())}function Z(e,t){1&e&&(d.TgZ(0,"span"),d._UZ(1,"i",25),d.qZA())}function b(e,t){1&e&&(d.TgZ(0,"div",26),d._UZ(1,"i",27),d.qZA())}const A=[{path:"",component:(()=>{class e{constructor(e,t,i,r,n,o){this.nav=e,this.activatedRoute=t,this.api=i,this.toast=r,this.notiServ=n,this.pushService=o,this.loading={checkingCode:!1,updatingPassword:!1},this.teacher=null,this.activationToken=null,this.passwordForm=new s.cw({password:new s.NI("",[s.kI.required,s.kI.minLength(3)]),confirmPassword:new s.NI("",[s.kI.required,s.kI.minLength(3)])})}ngOnInit(){this.GetParams()}GetParams(){this.activatedRoute.params.subscribe(e=>{this.activationToken=e.activationToken,this.GetTeacher()})}GetTeacher(){this.loading.checkingCode=!0,this.api.Get(`/Teachers/ByActivationToken/${this.activationToken}`).subscribe(e=>{this.teacher=e,this.loading.checkingCode=!1},e=>{console.error("Error getting teacher",e),this.loading.checkingCode=!1,"invalid token"==e.error.error.message&&this.toast.ShowError("Este link ya ha expirado")})}OnPasswordChange(){var e,t;const i=null===(e=this.passwordForm.get("password"))||void 0===e?void 0:e.value;null===(t=this.passwordForm.get("confirmPassword"))||void 0===t||t.setValidators([s.kI.required,s.kI.minLength(3),c.R.matchString(i)])}SetPasswordAndLogin(){if(this.passwordForm.invalid)return this.toast.ShowWarning("Favor de llenar todos los campos correctamente"),void this.passwordForm.markAllAsTouched();let e=this.passwordForm.value;this.loading.updatingPassword=!0,this.api.Patch(`/Teachers/${this.teacher.id}/Activate`,{password:e.password}).subscribe(t=>{this.Login({email:this.teacher.email,password:e.password})},e=>{console.error("error activating teacher",e),this.loading.updatingPassword=!1})}Login(e){this.api.Post("/Usuarios/login",{email:e.email,password:e.password},!1).subscribe(e=>{localStorage.clear(),this.api.SetToken(e.id),this.api.Get("/Usuarios/withCredentials",!0).subscribe(e=>{localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("ttl",l().add(1209600,"s").toISOString()),this.notiServ.LoadNotifications(),this.pushService.GetUserID(),this.toast.ShowSuccess("Sesi\xf3n iniciada exitosamente");let t=this.api.GetUser().role.name.toLowerCase();this.loading.updatingPassword=!1,this.nav.GoTo(`/inicio/${t}/`)},e=>{this.loading.updatingPassword=!1,this.toast.ShowError(e.error.error.message)})},e=>{this.loading.updatingPassword=!1,this.toast.ShowError(e.error.error.message)})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u.f),d.Y36(n.gz),d.Y36(g.sM),d.Y36(m.k),d.Y36(h.g),d.Y36(p._))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-verification"]],decls:24,vars:5,consts:[[1,"full-page"],[1,"d-flex","h-100"],["src","assets/img/landing_page_side.png","alt","Side img",1,"side-img"],[1,"w-100","vertical-content"],[1,"row","m-0"],[1,"col-12","text-center"],["src","assets/img/project_name.png","alt","Bluetopia",1,"title-img"],[1,"header-container"],[1,"title"],["src","assets/img/landing_page_img.png","alt","Image",1,"landing-image"],[1,"subtitle"],[1,"text-center"],["class","form-container",3,"formGroup",4,"ngIf","ngIfElse"],[1,"mt-5"],[1,"d-flex","justify-content-center"],[1,"btn","btn-outline-primary","btn-bigger",3,"disabled","click"],[4,"ngIf"],["bigLoading",""],[1,"form-container",3,"formGroup"],[1,"input-container"],[1,"input-icon-container","text-center"],["src","assets/icons/lock.png"],["type","password","placeholder","Contrase\xf1a","formControlName","password",1,"form-control",3,"input"],[3,"control"],["type","password","placeholder","Confirmar contrase\xf1a","formControlName","confirmPassword",1,"form-control"],[1,"zmdi","zmdi-spinner","zmdi-hc-2x","zmdi-hc-spin"],[1,"w-100","text-center"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"]],template:function(e,t){if(1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d._UZ(2,"img",2),d.TgZ(3,"div",3),d.TgZ(4,"div",4),d.TgZ(5,"div",5),d.TgZ(6,"div"),d._UZ(7,"img",6),d.qZA(),d.TgZ(8,"div",7),d.TgZ(9,"div",8),d._uU(10," \xa1Bienvenido! "),d.qZA(),d.TgZ(11,"div"),d._UZ(12,"img",9),d.qZA(),d.TgZ(13,"div",10),d._uU(14," Para temrinar la creaci\xf3n de su cuenta porfavor ingrese una contrase\xf1a "),d.qZA(),d.qZA(),d.TgZ(15,"div",11),d.YNc(16,w,11,3,"form",12),d.qZA(),d.TgZ(17,"div",13),d.TgZ(18,"div",14),d.TgZ(19,"button",15),d.NdJ("click",function(){return t.SetPasswordAndLogin()}),d.YNc(20,f,2,0,"span",16),d.YNc(21,Z,2,0,"span",16),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(22,b,2,0,"ng-template",null,17,d.W1O)),2&e){const e=d.MAs(23);d.xp6(16),d.Q6J("ngIf",!t.loading.checkingCode)("ngIfElse",e),d.xp6(3),d.Q6J("disabled",t.loading.updatingPassword||t.loading.checkingCode),d.xp6(1),d.Q6J("ngIf",!t.loading.updatingPassword),d.xp6(1),d.Q6J("ngIf",t.loading.updatingPassword)}},directives:[r.O5,s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,v.w],styles:[".title[_ngcontent-%COMP%]{margin:1rem 0}.landing-image[_ngcontent-%COMP%]{margin:38px 0;max-height:150px}.header-container[_ngcontent-%COMP%]{max-width:500px;display:inline-block}.subtitle[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:500;color:#758ca6;margin-bottom:50px}.form-container[_ngcontent-%COMP%]{display:inline-block;max-width:500px;width:100%}"]}),e})()}];let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[s.u5,r.ez,o.A0,s.UX,a.G,n.Bz.forChild(A)]]}),e})()},407:(e,t,i)=>{"use strict";i.d(t,{f:()=>s});var r=i(7368),n=i(2320),o=i(1392);let s=(()=>{class e{constructor(e,t){this.router=e,this.api=t,this.user=null}HasInitialSlash(e){return!!e&&"/"==e.charAt(0)}GoToUserRoute(e){this.user=this.api.GetUser(),this.user&&(this.user&&this.user.role&&!e.includes(this.user.role.name.toLowerCase())?this.router.navigate([`/inicio/${this.user.role.name.toLowerCase()}${this.HasInitialSlash(e)?"":"/"}${e}`]):this.router.navigate([`${this.HasInitialSlash(e)?"":"/"}${e}`]))}GoTo(e){this.router.navigate([`${this.HasInitialSlash(e)?"":"/"}${e}`])}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(n.F0),r.LFG(o.sM))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},5821:(e,t,i)=>{"use strict";i.d(t,{R:()=>n});var r=i(7368);let n=(()=>{class e{constructor(){}static GetValidatorErrorMessage(e,t){return[{name:"required",label:"Campo requerido"},{name:"invalidRFC",label:"No tiene el formato adecuado"},{name:"invalidEmailAddress",label:"Correo inv\xe1lido"},{name:"invalidPassword",label:"Las contrase\xf1as no coinciden"},{name:"minlength",label:`M\xednimo ${t.requiredLength} caracteres `},{name:"maxlength",label:`M\xe1ximo ${t.requiredLength} caracteres `},{name:"invalidNumber",label:"Solo n\xfameros enteros, o con decimal"},{name:"invalidIntegerNumber",label:"Solo n\xfameros enteros"},{name:"matchstring",label:`${t.matchStringCustomLabel?t.matchStringCustomLabel:"El texto no coincide"}`}].find(t=>t.name==e)}static matchString(e,t=null){return i=>i.value?e==i.value?null:t?{matchstring:{requiredString:e,matchStringCustomLabel:t}}:{matchstring:e}:null}static CheckOnlyIntegerNumbers(e){return(null==e?void 0:e.value)?/^[0-9]+$/.test(null==e?void 0:e.value)?0==(null==e?void 0:e.value)?{invalidIntegerNumber:!0}:null:{invalidIntegerNumber:!0}:null}static CheckOnlyNumbers(e){return(null==e?void 0:e.value)?/^[1-9]\d*\.?\d*$/.test(null==e?void 0:e.value)?0==(null==e?void 0:e.value)?{invalidNumber:!0}:null:{invalidNumber:!0}:null}static EmailValidator(e){return(null==e?void 0:e.value.match(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/))?null:{invalidEmailAddress:!0}}static RfcValidator(e){return(null==e?void 0:e.value)&&(null==e?void 0:e.value.match(/^([A-Z\xd1&]{3,4}) ?(?:- ?)?(\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])) ?(?:- ?)?([A-Z\d]{2})([A\d])$/))?null:{invalidRFC:!0}}}return e.password="",e.confirmPassword="",e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);