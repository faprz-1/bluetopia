(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[432],{2432:(e,t,i)=>{"use strict";i.r(t),i.d(t,{EventDayModule:()=>k});var n=i(1116),o=i(2320),r=i(4391),s=i(1041),l=i(6050),a=i(5470),c=i(9355),d=i(7368),u=i(1392),g=i(407),f=i(6189);const m=["libraryFileSelectorModal"],v=function(e){return{selected:e}};function p(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",12),d.NdJ("click",function(){const t=d.CHM(e).$implicit;return d.oxw().ToggleFile(t)}),d._UZ(1,"i",13),d._uU(2),d.qZA()}if(2&e){const e=t.$implicit;d.Q6J("ngClass",d.VKq(2,v,e.selected)),d.xp6(2),d.hij(" ",e.name," ")}}const h=function(){return{backdrop:"static",keyboard:!1}};let Z=(()=>{class e{constructor(e){this.api=e,this.onFilesSelectd=new d.vpe,this.user=null,this.files=[]}ngOnInit(){this.user=this.api.GetUser(),this.GetLibraryFiles()}OpenModal(){var e;null===(e=this.modal)||void 0===e||e.show()}CloseModal(){var e;null===(e=this.modal)||void 0===e||e.hide()}GetLibraryFiles(){this.api.Get(`/Usuarios/${this.user.id}/FileLibrary`).subscribe(e=>{console.log(e),this.files=e},e=>{console.error("Error getting the files",e)})}ToggleFile(e){e.selected=!e.selected}SelectFiles(){this.onFilesSelectd.emit(this.files.filter(e=>e.selected))}Reset(){this.files.forEach(e=>e.selected=!1)}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u.sM))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-library-file-selector-modal"]],viewQuery:function(e,t){if(1&e&&d.Gf(m,5),2&e){let e;d.iGM(e=d.CRH())&&(t.modal=e.first)}},outputs:{onFilesSelectd:"onFilesSelectd"},decls:15,vars:3,consts:[["bsModal","","tabindex","-1","role","dialog","aria-labelledby","libraryFileSelectorModal",1,"modal","fade",3,"config"],["libraryFileSelectorModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-body"],[1,"text","text-center"],[1,"files"],["class","file clickeable",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"modal-footer","justify-content-around"],[1,"btn","btn-bigger","btn-outline-primary","modal-btn",3,"click"],[1,"btn","btn-bigger","btn-primary","modal-btn",3,"click"],[1,"file","clickeable",3,"ngClass","click"],[1,"zmdi","zmdi-file","zmdi-hc-2x","mr-3"]],template:function(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",0,1),d.TgZ(2,"div",2),d.TgZ(3,"div",3),d._UZ(4,"div",4),d.TgZ(5,"div",5),d.TgZ(6,"div",6),d._uU(7," Selecciona los archivos que deseas adjuntar "),d.qZA(),d.TgZ(8,"div",7),d.YNc(9,p,3,4,"div",8),d.qZA(),d.qZA(),d.TgZ(10,"div",9),d.TgZ(11,"button",10),d.NdJ("click",function(){return d.CHM(e),d.MAs(1).hide(),t.Reset()}),d._uU(12," Cancelar "),d.qZA(),d.TgZ(13,"button",11),d.NdJ("click",function(){d.CHM(e);const i=d.MAs(1);return t.SelectFiles(),i.hide()}),d._uU(14," Aceptar "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.Q6J("config",d.DdM(2,h)),d.xp6(9),d.Q6J("ngForOf",t.files))},directives:[a.oB,n.sg,n.mk],styles:[".files[_ngcontent-%COMP%]{display:flex;width:100%;flex-wrap:wrap;max-height:50vh;overflow-y:auto}.files[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.8rem 1.2rem;margin:.5rem;flex-grow:1;border-radius:12px;border:2px solid #587594}.selected[_ngcontent-%COMP%]{border:4px solid #1081fb!important}"]}),e})();function b(e,t){1&e&&(d.TgZ(0,"div",32),d._UZ(1,"img",33),d._UZ(2,"img",34),d._UZ(3,"img",35),d.qZA())}function x(e,t){if(1&e&&(d.TgZ(0,"div",38),d._UZ(1,"i",39),d._uU(2),d.qZA()),2&e){const e=t.$implicit;d.xp6(2),d.hij(" ",e.name," ")}}function A(e,t){if(1&e&&(d.TgZ(0,"div",36),d.YNc(1,x,3,1,"div",37),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngForOf",e.GetFiles("new"))}}function w(e,t){1&e&&(d.TgZ(0,"div",32),d._UZ(1,"img",40),d._UZ(2,"img",41),d._UZ(3,"img",42),d.qZA())}function y(e,t){if(1&e&&(d.TgZ(0,"div",38),d._UZ(1,"i",39),d._uU(2),d.qZA()),2&e){const e=t.$implicit;d.xp6(2),d.hij(" ",e.name," ")}}function _(e,t){if(1&e&&(d.TgZ(0,"div",36),d.YNc(1,y,3,1,"div",37),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngForOf",e.GetFiles("old"))}}function q(e,t){1&e&&(d.TgZ(0,"span"),d._uU(1,"Continuar"),d.qZA())}function T(e,t){1&e&&(d.TgZ(0,"span"),d._UZ(1,"i",43),d.qZA())}let F=(()=>{class e{constructor(e,t,i,n){this.api=e,this.nav=t,this.activatedRoute=i,this.toast=n,this.activities=[],this.loading=!1,this.eventForm=new s.cw({start:new s.NI(null,[s.kI.required]),body:new s.NI(null,[s.kI.required]),closure:new s.NI(null,[s.kI.required]),date:new s.NI(null,[s.kI.required]),strategyId:new s.NI(null,[s.kI.required]),parcialProjectId:new s.NI(null,[s.kI.required]),resources:new s.NI([],[])})}get formatedDate(){return this.eventDate?c(this.eventDate).format("DD/MM/YY"):""}ngOnInit(){this.GetParams()}GetParams(){this.activatedRoute.params.subscribe(e=>{var t,i;this.strategyId=e.strategyId,this.eventDate=e.eventDate,null===(t=this.eventForm.get("date"))||void 0===t||t.setValue(c(this.eventDate).toISOString()),null===(i=this.eventForm.get("strategyId"))||void 0===i||i.setValue(this.strategyId),this.GetStrategyTeacherActivities()})}GoBack(){this.nav.GoToUserRoute(`estrategias/${this.strategyId}/calendario`)}GetStrategyTeacherActivities(){this.api.Get(`/Strategies/${this.strategyId}/Activities`).subscribe(e=>{this.activities=e.filter(e=>!e.eventId)},e=>{console.error("Error getting activities",e)})}OnFileSelected(e){Array.from(e.target.files).forEach(e=>{const t=new FileReader;t.onload=t=>{var i,n;let o={encodedFileContainer:"resources",base64File:btoa(t.target.result),name:e.name,resize:!1,fileExtention:"."+(null===(i=e.name.split(".").pop())||void 0===i?void 0:i.toLowerCase())};null===(n=this.eventForm.get("resources"))||void 0===n||n.value.push(o)},t.readAsBinaryString(e)})}OnLibraryFilesSelected(e){var t,i;null===(t=this.eventForm.get("resources"))||void 0===t||t.setValue(null===(i=this.eventForm.get("resources"))||void 0===i?void 0:i.value.concat(e))}SaveEvent(){if(this.eventForm.invalid)return this.toast.ShowWarning("Favor de llenar todos los campos"),void this.eventForm.markAllAsTouched();this.loading=!0,this.api.Post("/Events",{event:this.eventForm.value}).subscribe(e=>{this.loading=!1,this.toast.ShowSuccess("Evento creado correctamente"),this.GoBack()},e=>{console.error("Error creating event",e),this.loading=!1})}GetFiles(e){var t,i;switch(e){case"new":return null===(t=this.eventForm.get("resources"))||void 0===t?void 0:t.value.filter(e=>!e.id);case"old":return null===(i=this.eventForm.get("resources"))||void 0===i?void 0:i.value.filter(e=>!!e.id);default:return[]}}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(u.sM),d.Y36(g.f),d.Y36(o.gz),d.Y36(f.k))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-event-day"]],decls:57,vars:10,consts:[[1,"content"],[1,"row-header"],[1,"title"],[1,"d-flex","justify-content-between","align-items-end","mb-4"],[1,"back-section"],["src","assets/icons/back-arrow.png","alt","back-arrow",1,"back-icon","clickeable",3,"click"],[1,"event-date"],[1,"row","justify-content-center"],[1,"col-12","col-md-10","col-lg-8"],[3,"formGroup"],[1,"subtitle"],[1,"flex-row"],[1,"subtitle","my-auto"],[1,"input-container","w-75","my-auto"],["type","text","placeholder","Inicio","formControlName","start",1,"form-control","no-icon"],["type","text","placeholder","Desarrollo","formControlName","body",1,"form-control","no-icon"],["type","text","placeholder","Cierre","formControlName","closure",1,"form-control","no-icon"],[1,"input-container"],["bindLabel","name","bindValue","id","placeholder","Selecciona tu actividad","formControlName","parcialProjectId",1,"form-control","with-border",3,"items","multiple"],[1,"flex-files-container"],[1,"flex-files"],["class","flex-icons",4,"ngIf"],["class","flex-resources",4,"ngIf"],["type","file","multiple","",1,"d-none",3,"change"],["fileInput",""],[1,"btn","btn-success","btn-block",3,"click"],[1,"flex-files","mr-0"],[1,"col-12","text-right","mb-5"],[1,"btn","btn-primary","btn-bigger",3,"click"],[4,"ngIf"],[3,"onFilesSelectd"],["libraryModal",""],[1,"flex-icons"],["src","assets/icons/video-recorder.png","alt","video"],["src","assets/icons/gallery.png","alt","video"],["src","assets/icons/book-closed-green.png","alt","video"],[1,"flex-resources"],["class","resource",4,"ngFor","ngForOf"],[1,"resource"],[1,"zmdi","zmdi-file","zmdi-hc-2x","text-primary","mr-3"],["src","assets/icons/library.png","alt","video"],["src","assets/icons/movie.png","alt","video"],["src","assets/icons/microscope.png","alt","video"],[1,"zmdi","zmdi-spinner","zmdi-hc-lg","zmdi-hc-spin"]],template:function(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"div",0),d.TgZ(1,"div",1),d._UZ(2,"div"),d.TgZ(3,"div",2),d._uU(4," Calendario "),d.qZA(),d._UZ(5,"div"),d.qZA(),d.TgZ(6,"div",3),d.TgZ(7,"div",4),d.TgZ(8,"img",5),d.NdJ("click",function(){return t.GoBack()}),d.qZA(),d.qZA(),d.TgZ(9,"div",6),d._uU(10),d.qZA(),d._UZ(11,"div"),d.qZA(),d.TgZ(12,"div",7),d.TgZ(13,"div",8),d.TgZ(14,"form",9),d.TgZ(15,"div",10),d._uU(16," Selecciona tu estrategia "),d.qZA(),d.TgZ(17,"div",11),d.TgZ(18,"div",12),d._uU(19," Inicio "),d.qZA(),d.TgZ(20,"div",13),d._UZ(21,"input",14),d.qZA(),d.qZA(),d.TgZ(22,"div",11),d.TgZ(23,"div",12),d._uU(24," Desarrollo "),d.qZA(),d.TgZ(25,"div",13),d._UZ(26,"input",15),d.qZA(),d.qZA(),d.TgZ(27,"div",11),d.TgZ(28,"div",12),d._uU(29," Cierre "),d.qZA(),d.TgZ(30,"div",13),d._UZ(31,"input",16),d.qZA(),d.qZA(),d.TgZ(32,"div",10),d._uU(33," Asigna una actividad para ese d\xeda "),d.qZA(),d.TgZ(34,"div",17),d._UZ(35,"ng-select",18),d.qZA(),d.TgZ(36,"div",10),d._uU(37," Asigna los recursos a utilizar "),d.qZA(),d.TgZ(38,"div",19),d.TgZ(39,"div",20),d.YNc(40,b,4,0,"div",21),d.YNc(41,A,2,1,"div",22),d.TgZ(42,"input",23,24),d.NdJ("change",function(e){return t.OnFileSelected(e)}),d.qZA(),d.TgZ(44,"button",25),d.NdJ("click",function(){return d.CHM(e),d.MAs(43).click()}),d._uU(45," Adjuntar alg\xfan recurso "),d.qZA(),d.qZA(),d.TgZ(46,"div",26),d.YNc(47,w,4,0,"div",21),d.YNc(48,_,2,1,"div",22),d.TgZ(49,"button",25),d.NdJ("click",function(){return d.CHM(e),d.MAs(56).OpenModal()}),d._uU(50," Adjuntar de la biblioteca "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(51,"div",27),d.TgZ(52,"button",28),d.NdJ("click",function(){return t.SaveEvent()}),d.YNc(53,q,2,0,"span",29),d.YNc(54,T,2,0,"span",29),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(55,"app-library-file-selector-modal",30,31),d.NdJ("onFilesSelectd",function(e){return t.OnLibraryFilesSelected(e)}),d.qZA()}2&e&&(d.xp6(10),d.hij(" ",t.formatedDate," "),d.xp6(4),d.Q6J("formGroup",t.eventForm),d.xp6(21),d.Q6J("items",t.activities)("multiple",!1),d.xp6(5),d.Q6J("ngIf",!t.GetFiles("new").length),d.xp6(1),d.Q6J("ngIf",!!t.GetFiles("new").length),d.xp6(6),d.Q6J("ngIf",!t.GetFiles("old").length),d.xp6(1),d.Q6J("ngIf",!!t.GetFiles("old").length),d.xp6(5),d.Q6J("ngIf",!t.loading),d.xp6(1),d.Q6J("ngIf",t.loading))},directives:[s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,r.w9,n.O5,Z,n.sg],styles:[".title[_ngcontent-%COMP%]{color:#26d7a4}.subtitle[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:500;color:#587594;margin-bottom:.75rem}.event-date[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#fff;background-color:#26d7a4;padding:0 .8rem;border-radius:6px 6px 0 0}.flex-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem}.flex-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:1.5rem!important}.flex-files-container[_ngcontent-%COMP%]{display:flex}.flex-files[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;width:335px;margin:0 3rem 3rem 0}.flex-files[_ngcontent-%COMP%], .flex-icons[_ngcontent-%COMP%]{display:flex;align-items:center}.flex-icons[_ngcontent-%COMP%]{justify-content:space-around;height:100%}.flex-icons[_ngcontent-%COMP%], .flex-resources[_ngcontent-%COMP%]{width:100%;margin-bottom:1.25rem}.flex-resources[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.flex-resources[_ngcontent-%COMP%]   .resource[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.4rem}.btn-bigger[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:800;padding:1rem 8rem}@media (min-width:0px) and (max-width:925px){.flex-files-container[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.flex-files[_ngcontent-%COMP%]{margin-right:0;width:100%;max-width:335px}}@media (min-width:0px) and (max-width:550px){.flex-row[_ngcontent-%COMP%]{flex-direction:column!important}.w-75[_ngcontent-%COMP%]{width:100%!important}}"]}),e})(),C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[s.u5,n.ez,r.A0,s.UX,l.G,a.zk.forRoot()]]}),e})();const M=[{path:"",component:F}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[s.u5,n.ez,r.A0,s.UX,l.G,a.zk.forRoot(),C,o.Bz.forChild(M)]]}),e})()},407:(e,t,i)=>{"use strict";i.d(t,{f:()=>s});var n=i(7368),o=i(2320),r=i(1392);let s=(()=>{class e{constructor(e,t){this.router=e,this.api=t,this.user=null}HasInitialSlash(e){return!!e&&"/"==e.charAt(0)}GoToUserRoute(e){this.user=this.api.GetUser(),this.user&&(this.user&&this.user.role&&!e.includes(this.user.role.name.toLowerCase())?this.router.navigate([`/inicio/${this.user.role.name.toLowerCase()}${this.HasInitialSlash(e)?"":"/"}${e}`]):this.router.navigate([`${this.HasInitialSlash(e)?"":"/"}${e}`]))}GoTo(e){this.router.navigate([`${this.HasInitialSlash(e)?"":"/"}${e}`])}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(o.F0),n.LFG(r.sM))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);