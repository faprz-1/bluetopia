(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[4575],{4575:(e,t,s)=>{"use strict";s.r(t),s.d(t,{StrategiesModule:()=>Z});var r=s(1116),a=s(2894),i=s(4391),n=s(1041),o=s(6050),g=s(5470),l=s(6304),c=s(7368),d=s(1392),u=s(407),h=s(7390);function p(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",15),c.TgZ(1,"app-strategy-card",16),c.NdJ("onChange",function(t){return c.CHM(e),c.oxw(2).OnStrategyChange(t)}),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit;c.xp6(1),c.Q6J("strategy",e)}}function m(e,t){if(1&e&&(c.TgZ(0,"div",5),c.YNc(1,p,2,1,"div",14),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngForOf",e.strategies)}}function f(e,t){1&e&&(c.TgZ(0,"div",17),c._uU(1," No tiene estrategias creadas, cree una nueva estrategia "),c.qZA())}let S=(()=>{class e{constructor(e,t){this.api=e,this.nav=t,this.user=null,this.startegyStatuses=[],this.templates=[],this.grades=[],this.groups=[],this.gradeSelected=null,this.groupSelected=null,this.templateSelected=null,this.statusSelected=null,this.strategies=[],this.loading={}}ngOnInit(){var e=this;return(0,l.Z)(function*(){e.user=yield e.api.GetUser(),e.GetStrategies(),e.GetStrategyStatuses(),e.GetTemplates()})()}GetTemplates(){this.api.Get("/Templates").subscribe(e=>{this.templates=e},e=>{console.error("Error getting templates",e)})}GetStrategyStatuses(){this.api.Get("/StrategyStatuses").subscribe(e=>{this.startegyStatuses=e},e=>{console.error("Error statuses",e)}),this.GetTeacherGroups()}GetTeacherGroups(){var e;let t=this.api.GetUser();this.api.Get(`/TeacherGroups/of/${null===(e=t.teacher)||void 0===e?void 0:e.id}`).subscribe(e=>{this.SetGrades(e)},e=>{console.error("Error getting groups",e)})}SetGrades(e){this.grades=[],this.GroupByProperty(e,"gradeId").forEach(e=>{let t=e[0].grade;t.groups=e.map(e=>e.group),this.grades.push(t)}),this.grades=this.SortbyName(this.grades)}GroupByProperty(e,t){return Object.values(e.reduce((e,s)=>{const r=s[t];return e[r]||(e[r]=[]),e[r].push(s),e},{}))}SetGroupsOfSelectedGrade(e){if(this.groups=[],e&&null!=e&&0!=e){let t=this.grades.filter(t=>t.id==e);this.groups=t.length>0?t[0].groups:[]}else this.groups=[];this.groups=this.SortbyName(this.groups)}SortbyName(e){return e.sort((e,t)=>{const s=e.name.toLowerCase(),r=t.name.toLowerCase();return s.localeCompare(r)})}GetStrategies(){let e;switch(this.gradeSelected&&this.SetGroupsOfSelectedGrade(this.gradeSelected.id),this.user.role.name){case"School":e=`/Strategies/OfSchool/${this.user?this.user.schoolId:0}`;break;case"Teacher":e="/Strategies";break;default:e=""}e+=`/FilteredBy/Grade/${this.gradeSelected?this.gradeSelected.id:0}/Group/${this.groupSelected?this.groupSelected.id:0}/Template/${this.templateSelected?this.templateSelected.id:0}/Statuses/${JSON.stringify(this.statusSelected||[])}`,this.api.Get(e).subscribe(e=>{this.strategies=e,(this.gradeSelected||this.groupSelected)&&(this.strategies=this.strategies.filter(e=>{let t=e.strategyGroup;return(!this.gradeSelected||t&&t.grade&&t.grade.name==this.gradeSelected.name)&&(!this.groupSelected||t&&t.group&&t.group.name==this.groupSelected.name)}))},e=>{console.error("Erro getting teacher strategies",e)})}OnStrategyChange(e){switch(e.type){case"delete":let t=this.strategies.findIndex(t=>t.id==e.data.strategyId);-1!=t&&this.strategies.splice(t,1)}}GoToTeams(e){this.nav.GoToUserRoute(`mis-estrategias/${e.id}/equipos`)}GoToTeamsProgress(e){this.nav.GoToUserRoute(`mis-estrategias/${e.id}/progreso-equipos`)}GoToCalendar(e){this.nav.GoToUserRoute(`estrategias/${e.id}/calendario`)}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(d.sM),c.Y36(u.f))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-strategies"]],decls:18,vars:8,consts:[[1,"content"],[1,"row","mb-5"],[1,"col-12","d-flex","h-100","align-items-center","justify-content-between","header-col"],[1,"page-title"],[1,"btn","btn-primary",3,"click"],[1,"row"],[1,"col-12","d-flex","align-items-center","flex-wrap","filters","gap-3","mb-4"],[1,"select-container","filter"],["bindLabel","name","placeholder","Grado",1,"ng-select","form-control",3,"items","ngModel","change","ngModelChange"],["bindLabel","name","placeholder","Grupo",1,"ng-select","form-control",3,"items","ngModel","change","ngModelChange"],[1,"select-container","flex-grow-1","big","filter"],["bindLabel","name","placeholder","Tipo de estrategia",1,"ng-select","form-control","placeholder-primary",3,"items","ngModel","ngModelChange","change"],["class","row",4,"ngIf","ngIfElse"],["noStrategies",""],["class","col-12 col-md-6 col-lg-4 mb-1",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","col-lg-4","mb-1"],[3,"strategy","onChange"],[1,"text-center","no-items-message"]],template:function(e,t){if(1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c._uU(4," Mis estrategias "),c.qZA(),c.TgZ(5,"button",4),c.NdJ("click",function(){return t.nav.GoToUserRoute("plantillas")}),c._uU(6," Crear nueva estrategia "),c.qZA(),c.qZA(),c.qZA(),c.TgZ(7,"div",5),c.TgZ(8,"div",6),c.TgZ(9,"div",7),c.TgZ(10,"ng-select",8),c.NdJ("change",function(){return t.GetStrategies()})("ngModelChange",function(e){return t.gradeSelected=e})("change",function(){return t.GetStrategies()}),c.qZA(),c.qZA(),c.TgZ(11,"div",7),c.TgZ(12,"ng-select",9),c.NdJ("change",function(){return t.GetStrategies()})("ngModelChange",function(e){return t.groupSelected=e})("change",function(){return t.GetStrategies()}),c.qZA(),c.qZA(),c.TgZ(13,"div",10),c.TgZ(14,"ng-select",11),c.NdJ("ngModelChange",function(e){return t.templateSelected=e})("change",function(){return t.GetStrategies()}),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(15,m,2,1,"div",12),c.qZA(),c.YNc(16,f,2,0,"ng-template",null,13,c.W1O)),2&e){const e=c.MAs(17);c.xp6(10),c.Q6J("items",t.grades)("ngModel",t.gradeSelected),c.xp6(2),c.Q6J("items",t.groups)("ngModel",t.groupSelected),c.xp6(2),c.Q6J("items",t.templates)("ngModel",t.templateSelected),c.xp6(1),c.Q6J("ngIf",!!t.strategies.length)("ngIfElse",e)}},directives:[i.w9,n.JJ,n.On,r.O5,r.sg,h.c],styles:[".page-title[_ngcontent-%COMP%]{color:#3d5e81;font-size:24px;font-family:Mulish;font-weight:700}"]}),e})();var G=s(9188);const T=[{path:"",component:S}];let Z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[n.u5,r.ez,i.A0,G.b,n.UX,o.G,g.zk.forRoot(),a.Bz.forChild(T)]]}),e})()}}]);