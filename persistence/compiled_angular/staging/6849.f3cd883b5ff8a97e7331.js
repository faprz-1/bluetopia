(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[6849],{6849:(t,e,n)=>{"use strict";n.r(e),n.d(e,{StudentsCsvModule:()=>A});var o=n(1116),i=n(2894),a=n(4391),s=n(1041),r=n(6050),d=n(7368),l=n(2722),c=n(1148),u=n(1392),g=n(6189),p=n(407),m=n(5470),h=n(7536);const f=["confirmationModal"],b=function(t){return{checked:t}};function Z(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"div",13),d._uU(2," Es f\xe1cil registrar a tus alumnos "),d.qZA(),d.TgZ(3,"div",14),d._uU(4," Simplemente baja nuestra plantilla de Excel, ll\xe9nala y s\xfabela de nuevo "),d.qZA(),d.TgZ(5,"div",15),d.TgZ(6,"div",16),d._UZ(7,"div",17),d.TgZ(8,"div",18),d.TgZ(9,"div",19),d._uU(10,"1) Descarga el formato de Excel"),d.qZA(),d.TgZ(11,"div",20),d._UZ(12,"img",21),d.TgZ(13,"a",22),d.NdJ("click",function(){return d.CHM(t),d.oxw().DownloadTemplate()}),d._uU(14,"Descargar"),d.qZA(),d.qZA(),d.TgZ(15,"div",14),d._uU(16,"Si tienes m\xe1s de un nivel, repetir el proceso"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"div",16),d._UZ(18,"div",23),d.TgZ(19,"div",18),d.TgZ(20,"div",19),d._uU(21,"2) Llena la plantilla, te explicamos c\xf3mo."),d.qZA(),d.TgZ(22,"div",24),d._uU(23," Descarga tu plantilla, abre el documento y pega los campos con la informaci\xf3n de los alumnos. "),d.qZA(),d.TgZ(24,"div",24),d._uU(25," En la misma plantilla podr\xe1s subir los datos de todos los grupos y grados. "),d.qZA(),d.TgZ(26,"div",24),d.TgZ(27,"b",25),d._uU(28,"Recuerda que la falta de informaci\xf3n en cualquiera de los campos del documento puede impedir que el registro del alumno sea exitoso."),d.qZA(),d.qZA(),d.TgZ(29,"div",24),d._uU(30," Guarda los cambios y sube, a continuaci\xf3n, el mismo documento con la informaci\xf3n que ingresaste. "),d.qZA(),d.qZA(),d.qZA(),d.TgZ(31,"div",16),d._UZ(32,"div",23),d.TgZ(33,"div",18),d.TgZ(34,"div",19),d._uU(35,"3) Sube la plantilla con los datos de tus alumnos"),d.qZA(),d.TgZ(36,"input",26,27),d.NdJ("change",function(e){return d.CHM(t),d.oxw().OnFileChanged(e)}),d.qZA(),d.TgZ(38,"div",28),d.NdJ("click",function(){return d.CHM(t),d.MAs(37).click()}),d._UZ(39,"img",29),d._uU(40," Subir excel de alumnos "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&t){const t=d.oxw();d.xp6(18),d.Q6J("ngClass",d.VKq(2,b,t.instructionsStep>=2)),d.xp6(14),d.Q6J("ngClass",d.VKq(4,b,t.instructionsStep>=3))}}function x(t,e){if(1&t&&(d.TgZ(0,"div"),d.TgZ(1,"div",13),d._uU(2," \xa1Ya casi estamos listos para empezar! "),d.qZA(),d.TgZ(3,"div",14),d._uU(4," Estos son los grados y grupos que detectamos en tu archivo de excel, revisa que todo est\xe9 en orden para poder finalizar con tu registro. "),d.qZA(),d.TgZ(5,"div",14),d._uU(6," Primaria "),d.qZA(),d._UZ(7,"app-grades-groups-view",30),d.qZA()),2&t){const t=d.oxw();d.xp6(7),d.Q6J("students",t.students)}}const v=function(){return{backdrop:"static",keyboard:!1}};let C=(()=>{class t{constructor(t,e,n,o,i){this.downloadFile=t,this.csvService=e,this.api=n,this.toast=o,this.nav=i,this.areStudentsValid=!0,this.dataConversions=[{oldKey:"Nombre (Campo obligatorio)",newKey:"name"},{oldKey:"Primer Apellido (Campo obligatorio)",newKey:"fatherLastname"},{oldKey:"Segundo Apellido",newKey:"motherLastname"},{oldKey:"CURP (Campo obligatorio)",newKey:"registerNumber"},{oldKey:"Grado (Campo obligatorio)",newKey:"grade"},{oldKey:"Grupo (Campo obligatorio)",newKey:"group"}],this.students=[],this.loading={uploading:!1},this.step=1,this.instructionsStep=1}ngOnInit(){}DownloadTemplate(){this.instructionsStep<2&&(this.instructionsStep=2),this.downloadFile.DownloadWithoutApi("assets/docs/studentsTemplate.csv","studentsTemplate.csv")}Cancel(){this.step>1?this.step--:this.nav.GoToUserRoute("mis-estudiantes")}Continue(){switch(this.step){case 2:this.UploadStudents()}2!=this.step&&this.step++}OnFileChanged(t){const e=t.target.files[0];if(!e)return;const n=new FileReader;n.onload=t=>{this.csvService.ReadCSV(n.result).then(t=>{this.students=this.FormatData(t.data),0==this.students.length&&this.toast.ShowWarning("Sin alumnos por registrar"),this.areStudentsValid=this.ValidateStudents(this.students),this.areStudentsValid&&this.students.length>0?this.step++:this.step=1})},e&&(this.instructionsStep<3&&this.areStudentsValid&&this.students.length>0&&(this.instructionsStep=3),n.readAsText(e,"UTF-8"))}FormatData(t){const e=this.api.GetUser(),n=e.role.name;return t.map(t=>{let o={};return this.dataConversions.forEach(e=>{o[e.newKey]=t[e.oldKey]}),o.schoolId=e.schoolId,"Teacher"==n&&(o.teacherId=e.teacher.id),o})}UploadStudents(){this.loading.uploading=!0,this.api.Post("/Students/Array",{students:this.students}).subscribe(t=>{var e;this.toast.ShowSuccess("Estudiantes agregados correctamente"),this.loading.uploading=!1,null===(e=this.confirmationModal)||void 0===e||e.show()},t=>{this.toast.ShowError("Error al subir a los estudiantes"),console.error("Error at uploading students",t),this.loading.uploading=!1})}ValidateStudents(t){let e=!0,n=["name","fatherLastname","motherLastname","registerNumber"],o=new Map;return t.forEach(t=>{t.name||(e=!1,o.set(n[0],{required:!0,message:"Algunos estudiantes no tienen nombre"})),t.fatherLastname||o.set(n[0],{required:!1,message:"Algunos estudiantes no tienen apellido paterno"}),t.motherLastname||o.set(n[2],{required:!1,message:"Algunos estudiantes no tienen apellido materno"}),t.registerNumber||(e=!1,o.set(n[3],{required:!0,message:"Algunos estudiantes no tienen n\xfamero de registro"}))}),o.forEach(t=>{t.required?this.toast.ShowError(t.message):this.toast.ShowWarning(t.message)}),e}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(l.p),d.Y36(c.m),d.Y36(u.sM),d.Y36(g.k),d.Y36(p.f))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-students-csv"]],viewQuery:function(t,e){if(1&t&&d.Gf(f,5),2&t){let t;d.iGM(t=d.CRH())&&(e.confirmationModal=t.first)}},decls:19,vars:8,consts:[[1,"content"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"btns-group","mb-5"],[1,"btn","btn-outline-primary",3,"disabled","click"],[1,"btn","btn-primary",3,"disabled","click"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","first-time-configuration",1,"modal","fade",3,"config"],["confirmationModal","bs-modal"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-body","confirmation-modal"],["src","assets/icons/check-circle-md.png","alt","check.png",1,"my-5"],[1,"modal-text","mb-4"],[1,"title"],[1,"text"],[1,"steps"],[1,"d-flex"],[1,"radio-button","checked"],[1,"instructions"],[1,"step"],[1,"mb-5"],["src","assets/icons/excel.png","alt","CSV file",1,"img-template"],[1,"link",3,"click"],[1,"radio-button",3,"ngClass"],[1,"text","mb-4"],[1,"text-info"],["type","file","accept",".csv",1,"d-none",3,"change"],["studentsCsv",""],[1,"upload-container","clickeable",3,"click"],["src","assets/icons/upload.png","alt","CSV file"],[3,"students"]],template:function(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.YNc(2,Z,41,6,"div",2),d.YNc(3,x,8,1,"div",2),d.qZA(),d.TgZ(4,"div",3),d.TgZ(5,"button",4),d.NdJ("click",function(){return e.Cancel()}),d._uU(6," Cancelar "),d.qZA(),d.TgZ(7,"button",5),d.NdJ("click",function(){return e.Continue()}),d._uU(8," Continuar "),d.qZA(),d.qZA(),d.qZA(),d.TgZ(9,"div",6,7),d.TgZ(11,"div",8),d.TgZ(12,"div",9),d.TgZ(13,"div",10),d._UZ(14,"img",11),d.TgZ(15,"div",12),d._uU(16," Ha finalizado por ahora tu registro de grupos, podr\xe1s agregar grupos m\xe1s tarde. "),d.qZA(),d.TgZ(17,"button",5),d.NdJ("click",function(){return d.CHM(t),d.MAs(10).hide(),e.nav.GoToUserRoute("mis-estudiantes")}),d._uU(18," Continuar "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&t&&(d.xp6(1),d.Q6J("ngSwitch",e.step),d.xp6(1),d.Q6J("ngSwitchCase",1),d.xp6(1),d.Q6J("ngSwitchCase",2),d.xp6(2),d.Q6J("disabled",e.loading.uploading),d.xp6(2),d.Q6J("disabled",e.loading.uploading||!e.areStudentsValid),d.xp6(2),d.Q6J("config",d.DdM(7,v)),d.xp6(8),d.Q6J("disabled",e.loading.uploading))},directives:[o.RF,o.n9,m.oB,o.mk,h.d],styles:[".title[_ngcontent-%COMP%]{color:#2ed2a3;margin-bottom:20px;text-transform:none}.text[_ngcontent-%COMP%]{margin-bottom:30px}.step[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#758ca6;margin-bottom:30px!important}.img-template[_ngcontent-%COMP%]{margin-right:15px}.link[_ngcontent-%COMP%]{color:#2ed2a3}.radio-button[_ngcontent-%COMP%]{width:38px;height:38px;margin-right:50px;background-color:none;border:3px solid #1081fb;border-radius:38px}.radio-button.checked[_ngcontent-%COMP%]{background-color:#1081fb}.title-fake-line[_ngcontent-%COMP%]{height:9px;width:90px;border-radius:4px;background-color:#1081fb}.fake-line-lg[_ngcontent-%COMP%]{width:360px}.fake-line-lg[_ngcontent-%COMP%], .fake-line-md[_ngcontent-%COMP%]{height:9px;max-width:100%;border-radius:4px;background-color:#cad6e2}.fake-line-md[_ngcontent-%COMP%]{width:310px}.fake-line-sm[_ngcontent-%COMP%]{height:9px;width:285px;max-width:100%;border-radius:4px;background-color:#cad6e2}.last-line[_ngcontent-%COMP%]{margin-bottom:32px!important}.upload-container[_ngcontent-%COMP%]{display:inline-block;font-size:1rem;font-weight:500;color:#1081fb;padding:23px;border:3px dashed #1081fb;border-radius:20px}.upload-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:15px}.btns-group[_ngcontent-%COMP%]{margin-top:30px;display:flex;width:100%;justify-content:end}.btns-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%;max-width:250px;margin-left:50px;padding:16px 0}.modal-content[_ngcontent-%COMP%]{padding:2rem}.modal-footer[_ngcontent-%COMP%]{border:none}.modal-btn[_ngcontent-%COMP%]{font-size:1rem;font-weight:800;padding:.75rem 3rem}.confirmation-modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.modal-text[_ngcontent-%COMP%]{color:#3d5e81;line-height:30px;font-family:Mulish;font-weight:400;font-size:1.5rem;text-align:center;max-width:505px}"]}),t})();var w=n(7169),_=n(7687);const q=[{path:"",component:C}];let A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[s.u5,o.ez,a.A0,w.b,s.UX,r.G,_.M,m.zk.forRoot(),i.Bz.forChild(q)]]}),t})()}}]);