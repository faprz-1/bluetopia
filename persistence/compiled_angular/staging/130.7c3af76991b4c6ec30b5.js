(self.webpackChunktemplate_web=self.webpackChunktemplate_web||[]).push([[130],{6158:(e,t,i)=>{"use strict";i.d(t,{w:()=>s});var n=i(5821),r=i(7368),o=i(1116);function a(e,t){if(1&e&&(r.TgZ(0,"div",1),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",null==e.errorMessage?null:e.errorMessage.label,"\n")}}let s=(()=>{class e{constructor(){}ngOnInit(){}get errorMessage(){var e,t,i,r;for(let o in null===(e=this.control)||void 0===e?void 0:e.errors)if((null===(t=this.control)||void 0===t?void 0:t.errors.hasOwnProperty(o))&&(null===(i=this.control)||void 0===i?void 0:i.touched))return n.R.GetValidatorErrorMessage(o,null===(r=this.control)||void 0===r?void 0:r.errors[o]);return null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-control-messages"]],inputs:{control:"control"},decls:1,vars:1,consts:[["class","color-red",4,"ngIf"],[1,"color-red"]],template:function(e,t){1&e&&r.YNc(0,a,2,1,"div",0),2&e&&r.Q6J("ngIf",null!==t.errorMessage)},directives:[o.O5],styles:[""]}),e})()},9130:(e,t,i)=>{"use strict";i.r(t),i.d(t,{VerificationModule:()=>T});var n=i(1116),r=i(2894),o=i(4391),a=i(1041),s=i(6050),l=i(9609),d=i(5821),c=i(7368),g=i(407),u=i(1392),m=i(6189),h=i(2874),p=i(8118),v=i(6158);function w(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"form",18),c.TgZ(1,"div",19),c.TgZ(2,"div",20),c._UZ(3,"img",21),c.qZA(),c.TgZ(4,"input",22),c.NdJ("input",function(){return c.CHM(e),c.oxw().OnPasswordChange()}),c.qZA(),c._UZ(5,"app-control-messages",23),c.qZA(),c.TgZ(6,"div",19),c.TgZ(7,"div",20),c._UZ(8,"img",21),c.qZA(),c._UZ(9,"input",24),c._UZ(10,"app-control-messages",23),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("formGroup",e.passwordForm),c.xp6(5),c.Q6J("control",e.passwordForm.get("password")),c.xp6(5),c.Q6J("control",e.passwordForm.get("confirmPassword"))}}function f(e,t){1&e&&(c.TgZ(0,"span"),c._uU(1,"Continuar"),c.qZA())}function Z(e,t){1&e&&(c.TgZ(0,"span"),c._UZ(1,"i",25),c.qZA())}function b(e,t){1&e&&(c.TgZ(0,"div",26),c._UZ(1,"i",27),c.qZA())}const A=[{path:"",component:(()=>{class e{constructor(e,t,i,n,r,o){this.nav=e,this.activatedRoute=t,this.api=i,this.toast=n,this.notiServ=r,this.pushService=o,this.loading={checkingCode:!1,updatingPassword:!1},this.teacher=null,this.activationToken=null,this.passwordForm=new a.cw({password:new a.NI("",[a.kI.required,a.kI.minLength(3)]),confirmPassword:new a.NI("",[a.kI.required,a.kI.minLength(3)])})}ngOnInit(){this.GetParams()}GetParams(){this.activatedRoute.params.subscribe(e=>{this.activationToken=e.activationToken,this.GetTeacher()})}GetTeacher(){this.loading.checkingCode=!0,this.api.Get(`/Teachers/ByActivationToken/${this.activationToken}`).subscribe(e=>{this.teacher=e,this.loading.checkingCode=!1},e=>{console.error("Error getting teacher",e),this.loading.checkingCode=!1,"invalid token"==e.error.error.message&&this.toast.ShowError("Este link ya ha expirado")})}OnPasswordChange(){var e,t;const i=null===(e=this.passwordForm.get("password"))||void 0===e?void 0:e.value;null===(t=this.passwordForm.get("confirmPassword"))||void 0===t||t.setValidators([a.kI.required,a.kI.minLength(3),d.R.matchString(i)])}SetPasswordAndLogin(){if(this.passwordForm.invalid)return this.toast.ShowWarning("Favor de llenar todos los campos correctamente"),void this.passwordForm.markAllAsTouched();let e=this.passwordForm.value;this.loading.updatingPassword=!0,this.api.Patch(`/Teachers/${this.teacher.id}/Activate`,{password:e.password}).subscribe(t=>{this.Login({email:this.teacher.email,password:e.password})},e=>{console.error("error activating teacher",e),this.loading.updatingPassword=!1})}Login(e){this.api.Post("/Usuarios/login",{email:e.email,password:e.password},!1).subscribe(e=>{localStorage.clear(),this.api.SetToken(e.id),this.api.Get("/Usuarios/withCredentials",!0).subscribe(e=>{localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("ttl",l().add(1209600,"s").toISOString()),this.notiServ.LoadNotifications(),this.pushService.GetUserID(),this.toast.ShowSuccess("Sesi\xf3n iniciada exitosamente");let t=this.api.GetUser().role.name.toLowerCase();this.loading.updatingPassword=!1,this.nav.GoTo(`/inicio/${t}/`)},e=>{this.loading.updatingPassword=!1,this.toast.ShowError(e.error.error.message)})},e=>{this.loading.updatingPassword=!1,this.toast.ShowError(e.error.error.message)})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(g.f),c.Y36(r.gz),c.Y36(u.sM),c.Y36(m.k),c.Y36(h.g),c.Y36(p._))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-verification"]],decls:24,vars:5,consts:[[1,"full-page"],[1,"d-flex","h-100"],["src","assets/img/landing_page_side.png","alt","Side img",1,"side-img"],[1,"w-100","vertical-content"],[1,"row","m-0"],[1,"col-12","text-center"],["src","assets/img/project_name.png","alt","Bluetopia",1,"title-img"],[1,"header-container"],[1,"title"],["src","assets/img/landing_page_img.png","alt","Image",1,"landing-image"],[1,"subtitle"],[1,"text-center"],["class","form-container",3,"formGroup",4,"ngIf","ngIfElse"],[1,"mt-5"],[1,"d-flex","justify-content-center"],[1,"btn","btn-outline-primary","btn-bigger",3,"disabled","click"],[4,"ngIf"],["bigLoading",""],[1,"form-container",3,"formGroup"],[1,"input-container"],[1,"input-icon-container","text-center"],["src","assets/icons/lock.png"],["type","password","placeholder","Contrase\xf1a","formControlName","password",1,"form-control",3,"input"],[3,"control"],["type","password","placeholder","Confirmar contrase\xf1a","formControlName","confirmPassword",1,"form-control"],[1,"zmdi","zmdi-spinner","zmdi-hc-2x","zmdi-hc-spin"],[1,"w-100","text-center"],[1,"zmdi","zmdi-spinner","zmdi-hc-5x","zmdi-hc-spin"]],template:function(e,t){if(1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c._UZ(2,"img",2),c.TgZ(3,"div",3),c.TgZ(4,"div",4),c.TgZ(5,"div",5),c.TgZ(6,"div"),c._UZ(7,"img",6),c.qZA(),c.TgZ(8,"div",7),c.TgZ(9,"div",8),c._uU(10," \xa1Bienvenido! "),c.qZA(),c.TgZ(11,"div"),c._UZ(12,"img",9),c.qZA(),c.TgZ(13,"div",10),c._uU(14," Para temrinar la creaci\xf3n de su cuenta porfavor ingrese una contrase\xf1a "),c.qZA(),c.qZA(),c.TgZ(15,"div",11),c.YNc(16,w,11,3,"form",12),c.qZA(),c.TgZ(17,"div",13),c.TgZ(18,"div",14),c.TgZ(19,"button",15),c.NdJ("click",function(){return t.SetPasswordAndLogin()}),c.YNc(20,f,2,0,"span",16),c.YNc(21,Z,2,0,"span",16),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(22,b,2,0,"ng-template",null,17,c.W1O)),2&e){const e=c.MAs(23);c.xp6(16),c.Q6J("ngIf",!t.loading.checkingCode)("ngIfElse",e),c.xp6(3),c.Q6J("disabled",t.loading.updatingPassword||t.loading.checkingCode),c.xp6(1),c.Q6J("ngIf",!t.loading.updatingPassword),c.xp6(1),c.Q6J("ngIf",t.loading.updatingPassword)}},directives:[n.O5,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,v.w],styles:[".title[_ngcontent-%COMP%]{margin:1rem 0}.landing-image[_ngcontent-%COMP%]{margin:38px 0;max-height:150px}.header-container[_ngcontent-%COMP%]{max-width:500px;display:inline-block}.subtitle[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:500;color:#758ca6;margin-bottom:50px}.form-container[_ngcontent-%COMP%]{display:inline-block;max-width:500px;width:100%}"]}),e})()}];let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[a.u5,n.ez,o.A0,a.UX,s.G,r.Bz.forChild(A)]]}),e})()},5821:(e,t,i)=>{"use strict";i.d(t,{R:()=>r});var n=i(7368);let r=(()=>{class e{constructor(){}static GetValidatorErrorMessage(e,t){return[{name:"required",label:"Campo requerido"},{name:"invalidRFC",label:"No tiene el formato adecuado"},{name:"invalidEmailAddress",label:"Correo inv\xe1lido"},{name:"invalidPassword",label:"Las contrase\xf1as no coinciden"},{name:"minlength",label:`M\xednimo ${t.requiredLength} caracteres `},{name:"maxlength",label:`M\xe1ximo ${t.requiredLength} caracteres `},{name:"invalidNumber",label:"Solo n\xfameros enteros, o con decimal"},{name:"invalidIntegerNumber",label:"Solo n\xfameros enteros"},{name:"matchstring",label:`${t.matchStringCustomLabel?t.matchStringCustomLabel:"El texto no coincide"}`}].find(t=>t.name==e)}static matchString(e,t=null){return i=>i.value?e==i.value?null:t?{matchstring:{requiredString:e,matchStringCustomLabel:t}}:{matchstring:e}:null}static CheckOnlyIntegerNumbers(e){return(null==e?void 0:e.value)?/^[0-9]+$/.test(null==e?void 0:e.value)?0==(null==e?void 0:e.value)?{invalidIntegerNumber:!0}:null:{invalidIntegerNumber:!0}:null}static CheckOnlyNumbers(e){return(null==e?void 0:e.value)?/^[1-9]\d*\.?\d*$/.test(null==e?void 0:e.value)?0==(null==e?void 0:e.value)?{invalidNumber:!0}:null:{invalidNumber:!0}:null}static EmailValidator(e){return(null==e?void 0:e.value.match(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/))?null:{invalidEmailAddress:!0}}static RfcValidator(e){return(null==e?void 0:e.value)&&(null==e?void 0:e.value.match(/^([A-Z\xd1&]{3,4}) ?(?:- ?)?(\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])) ?(?:- ?)?([A-Z\d]{2})([A\d])$/))?null:{invalidRFC:!0}}}return e.password="",e.confirmPassword="",e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);