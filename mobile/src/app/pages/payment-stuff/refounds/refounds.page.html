<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Reembolsos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card *ngFor="let refound of refounds">
      <ion-list>
        <ion-item >
          <ion-label>
            <h2>{{refound.usuario?.username}}</h2>
          </ion-label>
        </ion-item>

        <ion-item *ngFor="let product of refound.productsList">
          <ion-label>
            <h3 >
              <ion-row>
                <ion-col size="6">{{product?.name}} ({{product?.quantity}})</ion-col>
                <ion-col size="6">{{product?.unit_price | currency}}</ion-col>
              </ion-row>
            </h3>
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-label>
            <p>Total: {{converPrice(refound.totalPrice) | currency}}</p>
          </ion-label>
        </ion-item>
        <ion-item *ngIf="refound.refounded">
          <span>Reembolsado</span>
        </ion-item>
        <ion-item *ngIf="!refound.change && !refound.refounded">
          <ion-button (click)="refound.change = !refound.change">Reembolsar</ion-button>
        </ion-item>
          <ion-item *ngIf="refound.change">
            <ion-row>
              <ion-col size="12">
                  <ion-label>Motivo del reembolso</ion-label>
                  <ion-select okText="Aceptar" cancelText="Cancelar" [(ngModel)]="reasonRefound">
                    <ng-container *ngFor="let reason of reasonsRefound">
                      <ion-select-option [value]="reason.id" [innerHTML]="reason.reason"></ion-select-option>
                    </ng-container>
                  </ion-select>
 
              </ion-col>
              
              <ion-col size="6"><ion-button (click)="refound.change = !refound.change">Cancelar</ion-button></ion-col>
              <ion-col size="6"><ion-button (click)="processRefound(refound)">Reembolsar</ion-button></ion-col>
            </ion-row>
          </ion-item>
      </ion-list>
  </ion-card>
</ion-content>
